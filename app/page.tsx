// app/page.tsx â€” ç¦®ç‰©é–‹å°å¼æƒ…æ›¸ç¶²ç«™ï¼ˆå¤šéšæ®µäº’å‹•æ¡†æ¶ï¼Œä¿®æ­£ Hooks é †åºï¼‰
// =====================================================
// è®Šæ›´é‡é»ï¼š
// - ä¿®æ­£ React Hooks è¦å‰‡ï¼šæ‰€æœ‰ useState/useEffect/useRef çš†åœ¨å…ƒä»¶é ‚å±¤å®£å‘Šã€‚
// - Stage åˆ‡æ›åƒ…å½±éŸ¿ã€Œæ˜¯å¦æ¸²æŸ“ã€ï¼Œä¸å½±éŸ¿ Hook å‘¼å«é †åºã€‚
// - novel éšæ®µçš„ wrapRef / progress ä¹Ÿç§»åˆ°é ‚å±¤ï¼Œä¸¦åœ¨ effect å…§ä»¥ stage åˆ¤æ–·æ˜¯å¦ç¶å®šäº‹ä»¶ã€‚
// =====================================================

"use client";

import React, { useEffect, useRef, useState } from "react";

// ===================== å…§å®¹è¨­å®šï¼ˆè«‹æ”¹é€™è£¡ï¼‰ =====================
const config = {
  loverName: "å°è·‘çš®",
  fromName: "å¤§ç‹—",
  finale: "ç¥ç¦æˆ‘å€‘ï¼Œéƒ½è¦é–‹é–‹å¿ƒï¼Œæœ‰å½¼æ­¤çš„é™ªä¼´ï¼Œå¸Œæœ›å¾€å¾Œé¤˜ç”Ÿéƒ½æ˜¯ä½ ã€‚",
  letters: [
    { text: "ç¬¬ä¸€æ¬¡å’Œå¦³å‡ºåœ‹çš„æˆ‘ï¼Œæ—¢èˆˆå¥®åˆç·Šå¼µï¼ŒæœŸå¾…æˆ‘å€‘å‡ºå»åˆæ€•ä½ æœƒç”Ÿæ°£", img: "/photos/japan-day1-01.jpg" },
    { text: "ç¬¬ä¸€æ¬¡èµ°åœ¨èŠ±ç«å¤§æœƒçš„è·¯ä¸Šï¼Œç…™ç«åƒæŠŠå¤œç©ºåˆ‡æˆå¾ˆå¤šæ®µï¼Œæˆ‘å€‘æ…¢æ…¢çš„æ¬£è³", img: "/photos/japan-day1-02.jpg" },
    { text: "æœ€å–œæ­¡çš„äº‹æƒ…ï¼Œå°±æ˜¯çœ‹è‘—ä½ ç¬‘ã€‚", img: "/photos/daily-01.jpg" },
    { text: "æœ‰æ²’æœ‰ç™¼ç¾ï¼Œæˆ‘å€‘ç©¿è‘—å’Œæœç‰¹åˆ¥é©åˆ", img: "/photos/daily-02.jpg" },
  {
    text: "åœ¨æ©Ÿå ´çš„è·¯ä¸Šï¼Œæˆ‘ä¸€å€‹äººæ‰›äº†ä¸‰å€‹è¡Œæï¼Œå¿ƒè£¡å»è¦ºå¾—ä¸€é»ä¹Ÿä¸ç´¯ï¼Œå› ç‚ºæ˜¯å¸¶è‘—ä½ ä¸€èµ·å»å†’éšªã€‚",
    img: "/photos/airport-luggage.jpg",
  },
  {
    text: "ç¬¬ä¸€æ¬¡ä½é€²å¤§é˜ªåŸæ—çš„é«˜æ¨“é…’åº—ï¼Œåœ¨ä¹é»é˜çš„å¤œè£¡ï¼Œåƒè‘—æœ€è²´çš„æ™šé¤ï¼Œå»è¦ºå¾—æœ€çè²´çš„æ˜¯ä½ çš„é™ªä¼´ã€‚",
    img: "/photos/hotel-dinner.jpg",
  },
  {
    text: "æ¸…æ™¨çš„é¤æ¡Œä¸Šï¼Œæ˜¨å¤©æˆ‘å€‘åšåˆ°å¤ªæ™šï¼Œè®“æˆ‘æ•´å€‹å°±å¾ˆæ²’ç²¾ç¥",
    img: "/photos/hotel-breakfast.jpg",
  },
  {
    text: "åœ¨å¤¾å¨ƒå¨ƒæ©Ÿå°å‰ï¼Œä½ çœ‹ä¸Šäº†ä¸€éš»ç¾æ¨‚è’‚ï¼Œæˆ‘èªªã€ä½ æƒ³è¦ï¼Œæˆ‘å°±ä¸€å®šè¦æŠŠç‰ å¸¶å›å®¶ã€ã€‚",
    img: "/photos/melody-doll.jpg",
  },
  {
    text: "æ—…é€”ä¸­å¤ªç´¯çš„å¤œæ™šï¼Œå›åˆ°æˆ¿é–“é è‘—ä¾è‘—ä½ ç¡è‘—äº†ï¼Œé‚£ä¸€åˆ»æ¯”ä»»ä½•å®‰çœ è—¥éƒ½å®‰å¿ƒã€‚",
    img: "/photos/sleep-shoulder.jpg",
  },
  {
    text: "æ¢…ç”°å¸‚ä¸­å¿ƒçš„äººæ½®è£¡ï¼Œæˆ‘å€‘æ…¢æ…¢æ•£æ­¥ï¼Œç›´åˆ°æ‰¾åˆ°ä½ è¦çš„æ„›é¦¬ä»•ï¼ˆçµæœæ²’æœ‰ï¼‰",
    img: "/photos/umeda-walk.jpg",
  },
  {
    text: "ç¬¬ä¸€æ¬¡å°¤ç‚ºé‡è¦ï¼Œå› æ­¤æˆ‘æŠŠé€™å€‹æ©Ÿæœƒçµ¦äº†ä½ ï¼Œæ­¤ç”Ÿæ²’æœ‰æ”¶éå°è±¡çš„ç¦®ç‰©ï¼Œè¬è¬ä½ è®“æˆ‘çŸ¥é“è¢«æ„›çš„æ„Ÿè¦º",
    img: "/photos/daily-toast.jpg",
  },
  {
    text: "ç¬¬ä¸€æ¬¡å’Œä½ å‡ºéŠï¼Œå°±é¸æ“‡äº†å°ä¸­ï¼Œå› ç‚ºæˆ‘çŸ¥é“å°ä¸­çš„é¢¨æ™¯å¾ˆç¾",
    img: "/photos/daily-street.jpg",
  },
  {
    text: "ä½ èªªéæƒ³è·Ÿæˆ‘ä¸€èµ·åƒæ³¡éºµï¼Œæ–¼æ˜¯åœ¨ä¸€å¤©çš„åŠå¤œè£¡ï¼Œæ‚„æ‚„æ‰“é–‹ä¸æƒ³åµåˆ°å®¶äºº",
    img: "/photos/daily-conbini.jpg",
  },
  {
    text: "æˆ‘æƒ³æŠŠé€™äº›ç¢ç‰‡éƒ½æ”¶é€²ä¾†â€”â€”å› ç‚ºåªè¦æœ‰ä½ ï¼Œæ‰€æœ‰æ—¥å¸¸éƒ½æ˜¯ç´€å¿µæ—¥ã€‚",
    img: "/photos/daily-memory.jpg",
  },
],

  longLetter: `
é¡Œè¨˜
é€™ä¸æ˜¯ä¸€å°æ™®é€šçš„æƒ…æ›¸ï¼Œè€Œæ˜¯ä¸€æœ¬é—œæ–¼ã€Œæˆ‘å€‘ã€çš„æ•…äº‹æ›¸ï¼Œæ¿ƒç¸®äº†æˆ‘å€‘é‡åˆ°çš„äº‹æƒ…ï¼Œä¸è«–æ˜¯é–‹å¿ƒé‚„æ˜¯ä¸æ„‰å¿«ï¼Œåœ¨æ¯æ¬¡çš„äº‹ä»¶å¾Œæˆ‘éƒ½æœ‰è¨˜éŒ„åœ¨æˆ‘çš„è¨˜äº‹æœ¬è£¡é¢ï¼Œæ‰æœ‰è¾¦æ³•èª•ç”Ÿé€™æ¨£çš„å°æƒ…æ›¸ï¼

å¾ç¬¬ä¸€æ¬¡é‡è¦‹ä½ ï¼Œåˆ°é€™å…©ç™¾äº”åå¤šå¤©è£¡çš„æ¯ä¸€å€‹æ—¥å­ï¼Œæˆ‘éƒ½æƒ³ä¸€å­—ä¸€å¥è¨˜éŒ„ä¸‹ä¾†ã€‚è£¡é¢æœ‰æˆ‘å€‘çš„ç¬‘è²ï¼Œä¹Ÿæœ‰æˆ‘å€‘çš„æ·šæ°´ï¼›æœ‰æˆ‘å€‘å› ç‚ºå°äº‹åµæ¶çš„ç¬é–“ï¼Œä¹Ÿæœ‰å½¼æ­¤æ“æŠ±æ™‚çš„å¿ƒè·³ã€‚
æˆ–è¨±å°‡ä¾†ï¼Œæ™‚é–“æœƒè®“æˆ‘å€‘éºå¿˜ä¸€äº›ç´°ç¯€ã€‚å¯èƒ½å¿˜äº†ç¬¬ä¸€æ¬¡èŠå¤©æ™‚ï¼Œä½ èªªéçš„é‚£å¥èª¿çš®çš„è©±ï¼›ä¹Ÿå¯èƒ½å¿˜äº†å“ªä¸€æ¬¡ä¸‹é›¨å¤©ï¼Œæˆ‘å¹«ä½ æ’å‚˜æ™‚ï¼Œé›¨æ°´é †è‘—å‚˜ç·£æ»´è½åœ¨åœ°çš„è²éŸ³ã€‚ä½†æˆ‘ç›¸ä¿¡ï¼Œç•¶æˆ‘å€‘å†è®€åˆ°é€™äº›æ–‡å­—ï¼Œæœƒåƒç¿»é–±ä¸€æœ¬èˆŠç›¸ç°¿ï¼Œæ¯ä¸€å€‹å­—éƒ½æœƒå–šèµ·ä¸€æ®µè¨˜æ†¶ï¼Œæé†’æˆ‘å€‘ï¼šé€™å°±æ˜¯å±¬æ–¼æˆ‘å€‘çš„é’æ˜¥ã€æ„›æƒ…ï¼Œä»¥åŠç„¡å¯å–ä»£çš„æ—¥å­ã€‚
é¡˜é€™æœ¬ã€Œæƒ…æ›¸ã€èƒ½åœ¨æœªä¾†çš„æŸä¸€å¤©ï¼Œæˆç‚ºæˆ‘å€‘çš„è¦‹è­‰ã€‚ç•¶æˆ‘å€‘å†æ¬¡é–±è®€æ™‚ï¼Œèƒ½å¾®ç¬‘è‘—èªªï¼šã€ŒåŸä¾†æˆ‘å€‘èµ°éçš„æ¯ä¸€åˆ»ï¼Œéƒ½é€™éº¼çè²´ã€‚ã€
ç¬¬ä¸€ç« ï½œåˆç›¸è­˜ï¼šé‚£å€‹å“ˆæ‘Ÿä»¥å¾Œ
2024å¹´çš„æŸä¸€å¤©ï¼Œæˆ‘å°±åƒå¾€å¸¸ä¸€æ¨£æ»‘è‘—Threadçœ‹è‘—åˆ¥äººç™¼è‘—æœ‰è¶£çš„æ–‡ç« ï¼Œçªç„¶çœ‹åˆ°ä¸€å€‹é€šçŸ¥ï¼Œä¸€å€‹å¥³ç”Ÿè¿½è¹¤äº†æˆ‘ï¼Ÿæˆ‘æƒ³èªªä»€éº¼æ™‚å€™è€å¤©çˆºä¹Ÿæœƒç™¼å¥½åƒçš„çµ¦æˆ‘äº†ï¼Œæˆ‘å°±è‡ªç„¶è€Œç„¶åœ°è¿½è¹¤å›å»ï¼Œé †ä¾¿ä¹ŸæŠŠäººå®¶çš„IGä¹Ÿè¿½è¹¤èµ·ä¾†ï¼Œçœ‹äº†ä½ çš„è²¼æ–‡å¾Œè¶Šç™¼è¦ºå¾—å¥‡æ€ªï¼Œä½†å°±é€™æ¨£éå»äº†ã€‚æŒ‰è®šæœ‰è¶£çš„æ±è¥¿ä¸€ç›´ä¾†æˆ‘çš„ç¿’æ…£ï¼Œæˆ‘ç•¶åˆä¹Ÿæ²’æœ‰å¤šæƒ³ï¼Œçœ‹åˆ°å¦³ç™¼çš„é™æ™‚å‹•æ…‹æˆ‘å°±éš¨æ‰‹æŒ‰äº†ï¼Œéš”äº†å¹¾å¤©ï¼Œæ‰“é–‹æ‰‹æ©Ÿå°±æ”¶åˆ°ä½ çš„é€šçŸ¥ï¼Œä½ ç«Ÿç„¶è·Ÿæˆ‘æ‰“æ‹›å‘¼ï¼šã€Œå“ˆæ‘Ÿã€ï¼Œæˆ‘çœ‹äº†åˆçœ‹é¡å­ï¼Œæˆ‘æ˜æ˜ä¸åƒæœƒè¢«æ­è¨•çš„äººå•Šï¼Œåˆçœ‹äº†çœ‹ä½ çš„è²¼æ–‡ï¼Œè¶Šç™¼è¦ºå¾—ä½ æ˜¯ä¸­åœ‹çš„è©é¨™ï¼ˆçœ‹å¤ªå¤šæŠ–éŸ³ï¼‰ï¼Œæ‰€ä»¥å‰›é–‹å§‹ä¸€ç›´æŠ±æŒè‘—æ‡·ç–‘çš„æ…‹åº¦è·Ÿä½ èŠå¤©ã€‚èŠå¤©çš„ç´°ç¯€å¤ªå¤šï¼Œäº‹éš”é‚£éº¼ä¹…æˆ‘å·²ç¶“æœ‰é»è¨˜ä¸æ¸…äº†ï¼Œä½†æˆ‘æœƒä¸€ç›´è¨˜å¾—ä½ å‰›é–‹å§‹è¦å›ä¸å›ï¼Œé›–ç„¶é‚£æ™‚çš„æˆ‘ä¹Ÿåœ¨å°ˆå¿ƒè™•ç†æˆ‘çš„äº‹æƒ…â€”â€”éº»å°‡ã€‚
æ²’éå¤šä¹…ï¼Œæˆ‘å°±ä¸»å‹•é‚€ç´„ä½ å»ä¿¡ç¾©å€å–é…’ï¼Œè¢«ä½ ç™¾èˆ¬æ‹’çµ•ï¼Œä½†æˆ‘ç§‰æŒè‘—æ—¢ç„¶èŠäº†æˆ‘å°±æƒ³è¦‹è¦‹ä½ ï¼Œå³ä½¿æœ€å¾Œæˆ‘å¯èƒ½æœƒè¢«æ‰“æ§ï¼Œä¸­å±±å…ˆç”Ÿé©å‘½éƒ½èŠ±äº†11æ¬¡æˆ‘è¢«æ‹’çµ•å¹¾æ¬¡åˆä½•å¦¨ï¼Ÿæ‰€ä»¥æˆ‘ä¾èˆŠæ‹‰ä¸‹è‡‰çš®ç´„ä½ ï¼Œåœ¨å¹¾æ¬¡çš„è»Ÿç£¨ç¡¬æ³¡ä¸‹ä½ çµ‚æ–¼ç­”æ‡‰æˆ‘ï¼Œç•¶å¤©æˆ‘å¾ˆç·Šå¼µï¼Œæˆ‘ç‰¹åˆ¥åœ¨å‰ä¸€å¤©æŠŠæˆ‘çš„æµ´å®¤åˆ·å¾—å¥½å¥½çš„ï¼ˆæˆ‘å…¶å¯¦ä¹Ÿä¸çŸ¥é“ç‚ºå•¥éœ€è¦ï¼‰ï¼Œå¯èƒ½æ˜¯å› ç‚ºä½ è·Ÿæˆ‘èªªéä½ å‡ºé–€å¾Œå°±ä¸èƒ½å›å®¶ï¼Œæˆ‘å°±æƒ³æŠŠä½ å¸¶å›ä¾†äº†ã€‚
11/15æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡è¦‹é¢ï¼Œä¹‹æ‰€ä»¥å°è±¡å¾ˆæ·±æ˜¯å› ç‚ºé‚£ä¸€é™£å­æˆ‘è·Ÿå¤§å­¸åŒå­¸è™•å¾—ä¸å¥½ï¼Œä»–å€‘é‚£ä¸€å¤©æ˜¯å­¸å¼Ÿå¦¹çš„åˆ¶æœè¶´ä»–å€‘éƒ½æ˜¯å·¥ä½œäººå“¡ï¼Œæˆ‘åŸæœ¬æ‡‰è©²å»çš„ä½†å› ç‚ºå„ç¨®åŸå› æˆ‘å°±æ²’æœ‰åƒåŠ å·¥ä½œï¼Œå‰›å¥½é‚£å¤©æˆ‘å°±è·Ÿä½ ç´„äº†ï¼Œåœ¨Fake Soberæ²’å¤šä¹…æˆ‘å°±çœ‹åˆ°ä»–å€‘ï¼Œå®³æˆ‘å¾ˆå°·å°¬ï¼Œéƒ­åŠ›å»·åŸæœ¬å°±çŸ¥é“ä½ é€™å€‹äººä»–å°±å•æˆ‘èªªï¼šã€Œé€™ä½æ˜¯ä½ å¥³æœ‹å‹å—ï¼Ÿã€ä½†é€™æ‰æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡è¦‹é¢ã€‚
å–é…’èŠå¤©çš„éç¨‹ä¸­ï¼Œæˆ‘ç™¼ç¾ä½ æ˜¯å€‹å¾ˆå®³ç¾çš„å¥³ç”Ÿï¼Œè·Ÿæˆ‘ç¶²è·¯ä¸ŠèŠå¤©çš„ä½ å®Œå…¨ä¸ä¸€æ¨£ï¼ŒèŠäº†å¾ˆå¤šæˆ‘ä¹Ÿä¸æ•¢å°æœ‰å¤ªå¤šæƒ³æ³•ï¼Œåªæƒ³è‘—èŠå¤©çœ‹è‘—ä½ çš„çœ¼ï¼ŒçµæŸå¾Œæˆ‘å°±å•ä½ è¦ç¡å“ªï¼Œå› ç‚ºä½ æ›¾ç¶“è·Ÿæˆ‘èªªéæ²’è¾¦æ³•å›å®¶ï¼Œæˆ‘å°±ä¸»å‹•å•ä½ èªªæ˜¯å¦è¦ä½æˆ‘é€™é‚Šï¼Œæ²’æƒ³åˆ°ä½ é¦¬ä¸Šå°±ç­”æ‡‰â€¦.å³ä½¿æˆ‘åšå¥½è¬å…¨çš„æº–å‚™æˆ‘é‚„æ˜¯æ²’æƒ³åˆ°ä½ çœŸçš„æœƒç­”æ‡‰ï¼Œå›æˆ¿é–“å¾Œäº‹æƒ…å°±ä¸€ç™¼ä¸å¯æ”¶æ‹¾äº†â€¦.ï¼ˆåœ–Aï¼‰
ç¬¬äºŒç« ï½œèªªä¸å‡ºå£çš„ç·Šå¼µï¼šå‘Šç™½å‰å¾Œ
11/26æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä¸»å‹•å»ä¸­åŸæ¥ä½ ï¼ŒåŸæœ¬åªæ˜¯æƒ³è¦å»ä¸­åŸæ‰¾ä½ èŠå¤©ï¼Œçµæœæ™ƒä¸€æ™ƒå°±åˆ°äº†åä¸€é»ï¼Œæˆ‘å°±æƒ³å•ä½ ä½ è¦ä¸è¦ä¾†æˆ‘å€‘å®¶ï¼Œç”šè‡³é¨™æˆ‘çˆ¸åª½èªªæˆ‘å€‘å†ä¸€èµ·ä¸€æ®µæ™‚é–“ï¼Œä½†å…¶å¯¦æ ¹æœ¬é‚„æ²’å†ä¸€èµ·å“ˆå“ˆå“ˆï¼Œä¾†çš„æ™‚å€™æˆ‘é‚„ç‰¹åˆ¥å¿ƒè™›ï¼Œæˆ‘æ²’æœ‰é¨™éæˆ‘åª½é€™ç¨®äº‹æƒ…ï¼Œä¸¦ä¸”æ²’æœ‰å¥³ç”Ÿä»¥å¥³æœ‹å‹çš„åç¾©ä¾†éæˆ‘å®¶ï¼Œæ‰€ä»¥æˆ‘ç‰¹åˆ¥çš„ç·Šå¼µã€‚
12/1æ˜¯æˆ‘è¦å»å°å¸«å¤§è€ƒæ—¥èªæª¢å®šæ—¥å­ï¼Œé‚£å¹¾å¤©æˆ‘ç‰¹åˆ¥ç·Šå¼µå› ç‚ºæˆ‘æº–å‚™äº†å¾ˆä¹…ï¼ŒåŒæ™‚æˆ‘ä¹Ÿæƒ³å•ä½ é¡˜ä¸é¡˜æ„é™ªæˆ‘å»ï¼Œæ²’æƒ³åˆ°çš„æ˜¯ä½ ç«Ÿç„¶é¡˜æ„é™ªæˆ‘å»è€ƒè©¦ï¼Œè€ƒè©¦æ™‚é–“é‚£éº¼ä¹…æˆ‘ä¹Ÿä¸çŸ¥é“ç‚ºä»€éº¼ä½ é¡˜æ„é™ªæˆ‘å»ï¼Œä½†ä½ äºŒè©±ä¸èªªå°±ä¾†äº†ï¼Œæˆ‘é‚„è¨˜å¾—æˆ‘å€‘æ—©ä¸Šå…«é»å°±è¦èµ·åºŠäº†ï¼Œæˆ‘å€‘éƒ½å¾ˆç´¯ä½†ä½ é‚„æ˜¯é¡˜æ„ç‚ºäº†æˆ‘æ—©èµ·ã€‚è€ƒå®Œè©¦æˆ‘å€‘å¾Œæˆ‘å€‘å°±ä¸€ç›´èµ°èµ°æ™ƒæ™ƒï¼Œèµ°åˆ°äº†æ¾è¸æˆ‘å€‘éƒ½ç´¯äº†ï¼Œå°±æ‰“ç®—åœä¸‹è…³æ­¥çœ‹çœ‹æœ‰ä»€éº¼å±•å»³ï¼Œæ²’æƒ³åˆ°èµ°é€²äº†ä¸€å€‹æˆ‘ä¹Ÿä¸çŸ¥é“åå­—çš„èŠ±åœ’ï¼Œæˆ‘å°±å’Œä½ æ‹å¼µç¬¬ä¸€å¼µå±¬æ–¼æˆ‘å€‘çš„åˆç…§ï¼Œä½†ç•¶æ™‚æ—é‚Šå°±åªæœ‰ä¸€å€‹çœ‹èµ·ä¾†åƒå°åº¦è£”çš„äººï¼Œæˆ‘å°±æƒ³èªªç®—äº†è«‹ä»–å¹«æˆ‘å€‘æ‹ï¼Œæ²’æƒ³åˆ°â€¦.æ˜¯çœŸçš„æ‹å¾—å¥½é†œï¼Œä½†ç•¢ç«Ÿæ˜¯æˆ‘å€‘ç¬¬ä¸€å¼µç…§ç‰‡ï¼Œæˆ‘å°±å¥½å¥½ç•™è‘—ï¼(åœ–B) 
12/24æˆ‘å¾ˆç·Šå¼µï¼Œæˆ‘å¿ƒç†å»ºè¨­äº†å¥½ä¹…ï¼Œä»Šå¤©æ˜¯æˆ‘æ‰“ç®—æ­£å¼å‘Šç™½çš„æ—¥å­ï¼Œä¸‹åˆçš„æ™‚å€™ä½ è·ŸYUKIå»ä¿¡ç¾©å»é€›è¡—ï¼Œæˆ‘æ•…æ„ç´„æ™šä¸€é»çš„æ™‚é–“è·Ÿä½ ç¢°é¢ï¼Œå°±æ˜¯å› ç‚ºæˆ‘è·‘å»è²·ç¦®ç‰©äº†ï¼é‚£å¤©æˆ‘å°è±¡å¾ˆæ·±åˆ»ï¼Œæˆ‘æ‰¾äº†å…©å®¶ä¸–è¯æ´›æ–½çªçš„åº—ï¼Œç¬¬ä¸€å®¶åº—çœŸçš„æœå¤ªå·®æˆ‘å°±å¾ˆç”Ÿæ°£ï¼Œè½‰é ­å»A11æ–°å…‰ä¸‰è¶Šè²·ï¼Œé‚£å®¶åº—å“¡å°±å¾ˆè©³ç´°çš„è·Ÿæˆ‘èªªæ˜ï¼Œé›–ç„¶æˆ‘æœ¬ä¾†å°±æŸ¥éæˆ‘è¦è²·ä»€éº¼ï¼Œä½†æˆ‘è¦è²·çš„é‚£æ¬¾åˆ°é‚£é‚Šæ²’è²¨ï¼Œæ‰€ä»¥æˆ‘é‚„æ˜¯è²·äº†ä¸€æ¬¾çœ‹èµ·ä¾†æ¯”è¼ƒé©åˆä½ çš„æ¬¾å¼ï¼Œåˆ°äº†åƒé£¯çš„æ™‚å€™æˆ‘ä¾èˆŠéå¸¸ç·Šå¼µï¼Œæˆ‘æ·±æ€•ä½ æœƒè·Ÿä¸Šæ¬¡ä¸€æ¨£æ‹’çµ•æˆ‘ï¼Œåœ¨å‘Šç™½å‰äº”åˆ†é˜ï¼Œæˆ‘ç‰¹åˆ¥å»å»æ‰€åšå¿ƒç†å»ºè¨­ï¼Œå›ä¾†å¾Œæˆ‘ç·Šå¼µä¸¦ä¸”é¡«é¡«å·å·çš„å•ä½ ï¼šã€Œä½ é¡˜æ„ç•¶æˆ‘å¥³æœ‹å‹å—ï¼Ÿã€æ²’æƒ³åˆ°ä½ æ²’æœ‰æ‹’çµ•æˆ‘ï¼Œåå€’ç›´æ¥çš„èªªï¼šã€Œæˆ‘é¡˜æ„ã€æˆ‘ä¸æ•¢ç½®ä¿¡åœ°åœ¨å•ä½ ä¸€æ¬¡ï¼Œä½ çš„å›è¦†ä¾èˆŠæ˜¯ï¼šã€Œæˆ‘é¡˜æ„ã€ï¼Œåˆ°é€™å¿ƒè£¡çš„å·¨çŸ³æ‰çµ‚æ–¼æ”¾ä¸‹ï¼ŒåŸä¾†ä½ ä¹Ÿæ˜¯å–œæ­¡æˆ‘çš„ã€‚(åœ–C) 
ç¬¬ä¸‰ç« ï½œæˆ‘å€‘çš„ç¬¬ä¸€å€‹å­£ç¯€ï¼šç›¸è™•çš„ç£¨åˆ
1/7 åŸæœ¬é‚„åœ¨éŸ“åœ‹çš„æˆ‘ï¼Œææ—©ä¸€å¤©å›åœ‹ç‚ºçš„å°±æ˜¯å¸Œæœ›å¯ä»¥è¶•å¿«è¦‹åˆ°ä½ ï¼Œé¦¬ä¸Šå¸¶å¦³å»è—æ–‡ç‰¹å€èµ°èµ°ï¼Œé€ä½ å›ä¸­å£¢çš„è·¯ä¸Šä½ çªç„¶èªªä½•å¿ƒé›²è¦æ‰¾ä½ åƒå®µå¤œï¼Œæ–¼æ˜¯æˆ‘å¥®ä¸é¡§èº«ï¼Œä¸ç®¡æ˜å¤©äº”é»å°±è¦èµ·åºŠå‡ºåœ‹å»æ—¥æœ¬ï¼Œæ²’æƒ³åˆ°é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°ä½ çš„æœ‹å‹å€‘ï¼Œé¡¯å¾—æˆ‘æœ‰é»å®³ç¾ï¼Œè€Œä¸”æˆ‘å€‘é‚„é‡åˆ°äº†ä»¥å¾Œé‡ä¸åˆ°çš„æ•¸å­¸ç”·å“ˆå“ˆå“ˆã€‚
1/22 æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡ä¸€èµ·åæ­£è¨€é †å‡ºå»ç©ï¼Œæˆ‘è€ƒæ…®äº†å¥½ä¹…æœ€å¾Œæ±ºå®šå¸¶å¦³å»å°ä¸­èµ°èµ°ï¼Œå› ç‚ºæˆ‘å¾ˆå–œæ­¡å°ä¸­çš„å¤©æ°£ï¼ˆé™¤äº†å…«å®¶é…’æ–‡åŒ–å¤–ï¼‰ï¼Œç¬¬ä¸€å¤©çš„æˆ‘å€‘å¾ˆé–‹å¿ƒï¼Œå…ˆå»ä½ æ‰¾çš„ä¸€å®¶å’–å•¡å»³ï¼Œç’°å¢ƒå¾ˆæ¼‚äº®ä½ ä¹ŸåŒæ¨£æ¼‚äº®ï¼Œä½†æ²’æƒ³åˆ°é‚„æ˜¯é‡åˆ°ä¸æƒ³é‡åˆ°çš„å…«å®¶é…’å“ˆå“ˆå“ˆï¼Œæ™šä¸Šæˆ‘å€‘å°±æ…¢æ…¢æ™ƒï¼Œæ™ƒåˆ°äº†å¤œå¸‚ï¼Œä½†é€™å€‹æ™‚å€™ä¸å¥½çš„äº‹æƒ…å°±ç™¼ç”Ÿäº†ï¼Œæˆ‘ä¸æƒ³å›æ†¶äº†ï¼Œå°ä¸èµ·å°å¯¶é‚£æ¬¡æ‡‰è©²æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡å¤§åµæ¶ï¼Œæ˜¯å› ç‚ºæˆ‘çš„ä¸å¥½è®“ä½ ç”Ÿæ°£ï¼Œæˆ‘ä¸æ‡‰è©²åœ¨ç•¶ä¸‹å°ä½ æ’’æ°£ã€‚éš”å¤©æˆ‘å€‘å…©å€‹å¾ˆæœ‰é»˜å¥‘çš„ç©¿ä¸€æ¨£çš„è¡£æœï¼Œå…¨èº«ç™½å»åƒå¥½åƒçš„æ—©åˆé¤ï¼Œçµæœä½ æ¯æ¬¡éƒ½æ²’æœ‰åƒå®Œéƒ½æœƒä¸Ÿçµ¦æˆ‘ç•¶å»šé¤˜æ¡¶ï¼Œæœ€å¾Œçš„æœ€å¾Œæˆ‘å€‘å»äº†æ—…é€”çš„æœ€å¾Œä¸€ç«™â€”â€”çœ‹æµ·ï¼Œæˆ‘å€‘è‰±é›£åœ°å¾è·¯ä¸Šèµ°åˆ°äº†æµ·é‚Šï¼Œé›–ç„¶æ²’è¾¦æ³•ä¸‹æµ·è¸©æ°´ï¼Œä½†æ˜¯æˆ‘å€‘æ‹äº†å¾ˆå¤šå¾ˆå¥½çœ‹çš„ç…§ç‰‡ã€è¢«é¢¨å¹å¾—é ­ç—›ï¼Œä½†æˆ‘å€‘å§‹çµ‚å†ä¸€èµ·ï¼Œæ°¸é å†ä¸€èµ·ã€‚(åœ–D)
2/12æ˜¯ä½ çš„ç”Ÿæ—¥ï¼Œç®—æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡éçš„ç¬¬ä¸€å€‹é‡è¦çš„ç¯€æ—¥ï¼Œæ‰€ä»¥æˆ‘å¾ˆç·Šå¼µï¼Œæˆ‘åŸæœ¬æƒ³è²·å¤§è›‹ç³•ä½†åˆæ€•æˆ‘å€‘åƒä¸å®Œï¼Œæˆ‘åˆåœ¨æƒ³è›‹ç³•æ€éº¼æœ‰è¾¦æ³•å·å·å¸¶é€²å»ä¸è¢«ä½ ç™¼ç¾ï¼Œæˆ‘å·®é»è«‹é™³å‹å‡±å¹«æˆ‘å…ˆè²·è›‹ç³•ï¼Œç„¶å¾Œæ‹¿å»é¤å»³è«‹ä»–å…ˆå†°èµ·ä¾†ï¼Œä½†å¾Œä¾†æˆ‘è¦ºå¾—æˆ‘çš„å€‹æ€§å°±æ˜¯å¤§è¾£è¾£ï¼Œæˆ‘æ‰“ç®—ç›´æ¥ç›´æ¥ä¸€é»ï¼Œæ‰€ä»¥æˆ‘å°±ä¸èº²èº²è—è—ï¼Œè›‹ç³•æåœ¨æ‰‹ä¸Šç¦®ç‰©ç¨å¾®è—äº†èµ·ä¾†ï¼Œç¦®ç‰©æˆ‘æº–å‚™äº†å¥½ä¹…ï¼Œæˆ‘æ‰¾äº†å¥½å¹¾å®¶åº—ï¼Œçµæœåªæœ‰é€™å®¶æœ‰è³£ï¼ˆæ²’æƒ³åˆ°å°±åœ¨æˆ‘å€‘å®¶æ—é‚Šï¼‰åƒé£¯æ™‚çœ‹ä½ é–‹å¿ƒåœ°ç¬‘è‘—ï¼Œè€Œæˆ‘åœ¨é‚£ä¸€åˆ»çŸ¥é“ï¼Œèƒ½ç‚ºä½ è£½é€ å¹¸ç¦ï¼Œæ˜¯æˆ‘æœ€å–œæ­¡åšçš„äº‹ã€‚å°å¯¶æƒ³è·Ÿä½ èªªï¼Œç¬¬ä¸€æ¬¡çš„æƒ…äººç¯€æ˜¯æˆ‘çš„å•é¡Œï¼Œæˆ‘æŠŠæˆ‘çš„ç¿’æ…£å¸¶ä¾†æˆ‘å€‘ç”Ÿæ´»ï¼Œæˆ‘ä»¥ç‚ºç¯€æ—¥é è¿‘å°±å¯ä»¥ä¸€èµ·éï¼Œé€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç­è§£åˆ°äº†ä½ çš„æƒ³æ³•ï¼Œå°ä¸èµ·è®“ä½ ç”Ÿæ°£ï¼Œæˆ‘ä»¥å¾Œçš„æƒ…äººç¯€å’Œä½ çš„ç”Ÿæ—¥ä¸€å®šæœƒåˆ†é–‹éï¼ï¼(åœ–E)
3/29 å¾ä½ å£ä¸­è½èªªä½ è¦å»è·Ÿæœ‹å‹åƒä¸‹åˆèŒ¶ï¼Œæˆ‘å°±ä¸‹å®šæ±ºå¿ƒæƒ³è¦å½Œè£œä¸Šæ¬¡çš„æƒ…äººç¯€ï¼Œæ–¼æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è²·äº†ä¸€æŸèŠ±é€çµ¦æˆ‘çš„æ„›äººï¼Œä½†åœ¨é€™ä¹‹å‰æ²’æœ‰éé€äººèŠ±çš„ç¶“é©—ï¼Œ å› æ­¤æˆ‘ç‰¹åˆ¥è·‘å»è·Ÿä½ åƒé£¯çš„æœ‹å‹ï¼Œå•ä»–ä½ å€‘åœ¨å“ªåƒã€å¤§æ¦‚å¹¾é»ä»¥åŠæˆ‘è¦æ€éº¼å·å·è¶ä½ ä¸æ³¨æ„é€ä½ ã€‚æœ€å¾Œæ±ºå®šè·Ÿä»–ä¸²é€šï¼Œè®“ä»–å‘Šè¨´ä½ ä»–è¦ä¸Šå»æ‰€è—‰æ­¤è®“æˆ‘æœ‰æ©Ÿæœƒèµ°é€²å»ä¸¦å¹«æˆ‘å€‘æ‹ç…§éŒ„å½±ï¼Œèµ°é€²å»çš„æ™‚å€™æˆ‘å¾ˆç·Šå¼µï¼Œæˆ‘æ²’æœ‰é€™æ¨£çµ¦éåˆ¥äººé©šå–œï¼Œä½ æ˜¯ç¬¬ä¸€å€‹ä¹Ÿæ˜¯å”¯ä¸€ä¸€å€‹ã€‚(åœ–F)
ç¬¬å››ç« ï½œæœæ—¥èˆ‡é›¨ï¼šæˆ‘å€‘åœ¨æ—¥å¸¸è£¡æˆé•·
4æœˆç™¼ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œæœ‰äº›æˆ‘çš„éŒ¯èª¤è¡Œç‚ºã€è®“ä½ ä¸é–‹å¿ƒç­‰ç­‰çš„ï¼Œä½†æ˜¯æˆ‘çš„å¿ƒè£¡ä¾èˆŠåªæœ‰ä½ ï¼Œæˆ‘é‚„è¨˜å¾—åœ¨4/1æˆ‘ç©¿å¾—å¾ˆæ­£å¼ï¼Œå› ç‚ºä½ æ›¾ç¶“è·Ÿæˆ‘èªªéä½ å–œæ­¡æˆ‘ç©¿è¥¿è£ï¼Œæˆ‘å°±ç©¿è‘—ç­†æŒºå¸¶ä½ å»åƒå¥½åƒçš„ç¾©å¤§åˆ©éºµï¼Œçµæœä½ ç«Ÿç„¶è·Ÿæˆ‘èªªä½ å‰æ›–æ˜§å°è±¡å¸¶ä½ ä¾†åƒéï¼Œæˆ‘æ˜¯çœŸçš„å¾ˆç”Ÿæ°£ï¼ï¼ï¼ï¼å¾Œä¾†æˆ‘å€‘ä¸€èµ·å»äº†æ¾è¸ï¼Œæˆ‘å¾ˆå–œæ­¡çœ‹æ›¸ä½ ä¹Ÿé¡˜æ„é™ªæˆ‘å»èµ°ä¸€èµ°ï¼Œæˆ‘å€‘åœ¨æ¾è¸æ‹äº†å¾ˆå¤šå¾ˆå¥½çœ‹çš„ç…§ç‰‡ï¼Œä¹Ÿåƒäº†å¥½è²´å¥½è²´çš„å†°æ·‡å‡Œã€‚æˆ‘ä¹Ÿè¨˜å¾—4/19æˆ‘å€‘ä¸€èµ·å»äº†ä¸­å±±ï¼ŒåŸæœ¬æƒ³å¸¶ä½ åƒå¥½åƒçš„ç¾©å¤§åˆ©éºµï¼Œçµæœä¸å°å¿ƒè¨‚åˆ°ä»–çš„åˆ†åº—ï¼Œåªæœ‰è³£æ¼¢å ¡å’Œå’–å–±é£¯ï¼Œè®“æˆ‘å¾ˆé›£éä»¥ç‚ºåˆå¯ä»¥å¸¶ä½ å»åƒåˆ°æ–°å“é …ï¼Œä½†ä¹Ÿå¥½åœ¨é€™å®¶åˆ†åº—çš„æ¼¢å ¡å’–å“©é£¯éƒ½å¾ˆå¥½åƒã€‚4/26ä¹Ÿæ˜¯ä¸€å€‹é–‹å¿ƒçš„æ—¥å­ï¼Œå› ç‚ºæˆ‘å€‘è·‘å»å®œè˜­å…©å¤©ä¸€å¤œï¼é€™æ¬¡æ˜¯æˆ‘å€‘ç¬¬äºŒæ¬¡å»å¤–ç¸£å¸‚æ—…éŠï¼Œæˆ‘å€‘ç¬¬ä¸€ç«™å°±è·‘å»åƒæˆ‘å–œæ­¡åƒçš„åœè‚‰ï¼Œå‰›é–‹å§‹æ“”å¿ƒä½ ä¸å–œæ­¡å› ç‚ºæœ‰é»é¹¹ï¼Œä½†çœ‹åˆ°ä½ ä¹Ÿå–œæ­¡æˆ‘å°±æ”¾å¿ƒä¸‹ä¾†äº†ï¼Œåœ¨æˆ‘å€‘çš„è¨è«–ä¸‹æˆ‘å€‘æœ€çµ‚è¨‚äº†æº«æ³‰é£¯åº—ï¼Œé”æˆæˆ‘å€‘é‚Šæ³¡æ¹¯é‚Šæ‰“ç ²çš„å¤¢æƒ³ï¼Œåœ¨é€™ä¹‹å¾Œæˆ‘å€‘é‚„å»çœ‹äº†å°å‹•ç‰©ï¼Œå¡çš®å·´æ‹‰ã€æ¢…èŠ±é¹¿é‚„æœ‰æˆ‘çš„æœ‹å‹â€”å¤§ç‹—ï¼Œçœ‹è‘—ä½ é–‹å¿ƒçš„è‡‰æˆ‘å°±è¦ºå¾—ååˆ†é–‹å¿ƒï¼Œè¦ºå¾—æˆ‘çš„ä»˜å‡ºéƒ½æ˜¯ç›´å¾—ï¼Œå› ç‚ºæˆ‘æ„›ä½ æˆ‘é¡˜æ„ç‚ºä½ ä»˜å‡ºæ‰€æœ‰ã€‚(åœ–G)
5/16 æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡å»æ‰‹ä½œæˆ’æŒ‡ï¼Œä¹Ÿæ˜¯æˆ‘äººç”Ÿç¬¬ä¸€æ¬¡å’Œå¥³æœ‹å‹æ‰‹ä½œæ±è¥¿ï¼Œä¹‹æ‰€ä»¥é¸æ“‡åšæˆ’æŒ‡æ˜¯å› ç‚ºåœ¨å®œè˜­çš„æ™‚å€™åŸæœ¬æƒ³è¦å¸¶ä½ å»åšï¼Œä½†æ™‚é–“å¤ªç·Šè¿«æ‰€ä»¥æœ€å¾Œå»¶åˆ°é€™å€‹æ™‚å€™ï¼Œæ‰¾äº†ä¸€å®¶å£ç¢‘é‚„ä¸éŒ¯ï¼Œæˆ‘å€‘åšçš„éç¨‹å¥½é–‹å¿ƒï¼ç”¨æ•²æ‰“çš„æ–¹å¼æ‰“ä¸Šäº†å°æ–¹çš„åå­—ä»¥åŠè‡ªå·±çš„åå­—åœ¨æˆ’æŒ‡çš„å…§å´ï¼Œæµ´å®¤æˆ‘å€‘æ°¸é ç¶å®šå†ä¸€èµ·ï¼æˆ‘å€‘é‚„äº’ç›¸ç­”æ‡‰äº†å½¼æ­¤æ¯å¹´éƒ½è¦ä¾†å®šæœŸæ´—æˆ’æŒ‡ï¼Œä¹Ÿä»£è¡¨è‘—æˆ‘å€‘æœƒå†ä¸€èµ·åˆ°æ°¸é ã€‚
5/20 æ˜¯ä¸€å€‹æˆ‘ä¸€è¼©å­éƒ½æœƒé›£å¿˜çš„æ—¥å­ï¼Œä½ å·å·è·‘ä¾†å¹«æˆ‘éç”Ÿæ—¥ï¼Œæˆ‘å®Œå…¨æ²’æœ‰å¯Ÿè¦ºï¼Œé€™æ˜¯ç¬¬ä¸€æ¬¡å¥³æœ‹å‹åœ¨æˆ‘ä¸çŸ¥æƒ…çš„æƒ…æ³ä¸‹è¢«éç”Ÿæ—¥ï¼Œæˆ‘å¾ˆé–‹å¿ƒä½†åŒæ™‚ä¹Ÿå¾ˆå¿ƒç–¼ä½ ï¼Œç‚ºäº†æˆ‘ä¸€å€‹å°å°çš„ç”Ÿæ—¥æ‰“è²»å‘¨ç« å¾ä¸­å£¢æ­è»Šéä¾†æ–°èŠï¼Œåœ¨é€™ä¹‹å‰ä½ ä¸€ç›´å•æˆ‘å–œæ­¡ä»€éº¼é¡è‰²çš„ç›¸æ¡†ã€ä»€éº¼é¡è‰²çš„èŠ±é©åˆé€äººé‚„æœ‰å·å·æ‹¿é‡‘æ²™çš„åŒ…è£åŒ¡æˆ‘çš„æˆ’åœï¼Œé€™äº›ç´°ç¯€æˆ‘éƒ½æ²’æœ‰ç™¼ç¾ï¼Œæˆ‘éƒ½ä»¥ç‚ºä½ åªæ˜¯éš¨å£å•å•éš¨å£ç©ç©ï¼Œæ²’æƒ³åˆ°ä½ åŸä¾†å¦æœ‰æ‰€åœ–ï¼Œæˆ‘åœ¨é€²æˆ¿é–“å¾Œå®Œå…¨æœ‰è¢«åš‡åˆ°ï¼Œå› ç‚ºæˆ‘æ²’æœ‰è¨­æƒ³åˆ°æ˜¯ä»Šå¤©ä¹Ÿæ²’æœ‰è¨­æƒ³éä½ æœƒä¸»å‹•å¹«æˆ‘éç”Ÿæ—¥ï¼Œæˆ‘é‚£æ™‚æƒ³å¾—å¾ˆç°¡å–®ï¼Œæˆ‘æ˜¯é€™ä¸–ç•Œä¸Šæœ€å¹¸ç¦çš„ç”·äººã€‚(åœ–H)
6/7 æ˜¯æˆ‘å€‘è·‘å»é€›IKEAçš„æ—¥å­ï¼ŒåŸæœ¬ä¸‹åˆçš„æ™‚å€™å¤©æ°£é‚„ä¸éŒ¯æƒ³å»æ–°åŒ—éƒ½æœƒå…¬åœ’ï¼Œæ²’æƒ³åˆ°çªç„¶ä¸‹é›¨äº†ï¼Œæˆ‘å€‘å°±é¦¬ä¸Šé¨è»Šå»IKEAé€›è¡—ï¼Œå‰›é–‹å§‹æˆ‘è¦ºå¾—å°±å¾ˆé–‹å¿ƒï¼Œå› ç‚ºæˆ‘æ²’æœ‰è·Ÿå¥³æœ‹å‹ä¸€èµ·é€›éå®¶å…·ï¼Œè®“æˆ‘æœ‰ä¸€ç¨®æˆ‘å€‘æœªä¾†è¦ä¸€èµ·æˆå®¶çš„æ„Ÿè¦ºï¼Œéè‘—é€›è‘—æˆ‘å€‘å°±æœƒé–‹å§‹æƒ³åƒæˆ‘å€‘ä¹‹å¾Œçš„æˆ¿é–“è©²é•·ä»€éº¼æ¨£å­ï¼Œå°å­©å­çš„æˆ¿é–“éœ€è¦ä»€éº¼ï¼Œå¾Œä¾†èµ°è‘—èµ°è‘—å°±é¤“äº†ï¼Œæ–¼æ˜¯æˆ‘å€‘å°±åƒäº†è£¡é¢çš„é¤å»³ï¼Œé€™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡åƒï¼Œæˆ‘å¾ˆå–œæ­¡ä»–å€‘çš„è‚‰çƒï¼Œé–‹å¿ƒçš„ä¸€å¤©å°±çµæŸï¼Œä½†æ²’æƒ³åˆ°é€™å€‹æ™‚å€™æº–å‚™å»ç‰½è»Šçš„æ™‚å€™ç™¼ç¾è»Šå­çš„é¾é ­æ—¢ç„¶æ’å‡¹äº†ï¼Œè€å©†ä½ å°±æœ‰è€å¿ƒçš„é™ªæˆ‘å»è­¦å¯Ÿå±€å ±æ¡ˆï¼Œç„¶å¾Œæˆ‘å€‘å°±è‡ªå·±æ‘¸æ‘¸é¼»å­æ­è¨ˆç¨‹è»Šå›æˆ¿é–“äº†ã€‚(åœ–I)
ç¬¬äº”ç« ï½œå®¶çš„æ–¹å‘ï¼šå®¶äººèˆ‡æœ‹å‹
7/4æ˜¯ä¸€å€‹éå¸¸ç·Šå¼µçš„æ—¥å­ï¼Œæˆ‘è¦è¦‹ä½ åª½åª½äº†ï¼ä»¥å‰éƒ½æ˜¯ä½ ç¶“å¸¸ä¾†æˆ‘å€‘å®¶ï¼Œæˆ‘çš„å®¶äººä»¥åŠæœ‹å‹å€‘éƒ½èªè­˜äº†éï¼Œä½†ç¬¬ä¸€æ¬¡è¦‹ä½ åª½åª½å±¬å¯¦éå¸¸è®“æˆ‘ç·Šå¼µï¼Œæˆ‘ä¸çŸ¥é“ä½ åª½åª½çš„å€‹æ€§ï¼Œä¹Ÿä¸çŸ¥é“ä½ åª½åª½æ˜¯å¦æœƒå–œæ­¡æˆ‘çš„é¢ç›¸ï¼Œä¸€åˆ‡éƒ½è®“æˆ‘éå¸¸æ“”å¿ƒï¼Œç¬¬ä¸€æ¬¡è¦‹çˆ¸åª½æˆ‘ä¸çŸ¥é“è¦å¸¶ä»€éº¼ç¦®ç‰©ï¼Œæ–¼æ˜¯æˆ‘å°±è²·äº†ä¸€å€‹æœ€ä¿éšªçš„â€”â€”ä¸Šæµ·æ˜Ÿå·´å…‹é™å®šé¦¬å…‹æ¯ï¼Œè·Ÿä½ åª½åª½åƒé£¯èŠå¤©çš„éç¨‹ä¸­ï¼Œç™¼ç¾ä»–éå¸¸çš„å¯æ„›ä¹Ÿå¾ˆæœƒèŠå¤©ï¼Œè·Ÿä½ ä¸€æ¨£å–œæ­¡åƒå¥½åƒçš„æ±è¥¿ï¼ŒåŸä¾†æˆ‘æ„›äººçš„åª½åª½ä¹Ÿæ˜¯ä¸€æ¨£çš„å¯æ„›ï¼Œä¸æ„§æ˜¯ä½ åª½åª½ç”Ÿçš„å‡ºä¾†ä½ é‚£éº¼å¯æ„›çš„å¥³å…’ã€‚(åœ–J)
7/9 æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä¹Ÿæ˜¯ä½ ç¬¬ä¸€æ¬¡å»è²“å’–ï¼Œæˆ‘å€‘å‰ä¸€å¤©æ™šä¸Šå°±ä¸€ç›´åœ¨æƒ³è¦å»å“ªè£¡å¥½ï¼ŒåŸæœ¬è¨ˆåŠƒå»çœ‹é›»å½±ä½†æœ€è¿‘æª”æœŸæ²’ä»€éº¼å¥½çœ‹çš„ï¼ŒåŸæœ¬åˆè¨ˆç•«è¦å»å¤§ç¨»åŸ•èµ°ä¸€èµ°é †ä¾¿æ´—æˆ’æŒ‡ï¼Œä½†æ˜¯ä¸çŸ¥é“ç‚ºå•¥æ²’å»ï¼Œæœ€å¾Œæ±ºå®šå»è©¦è©¦çœ‹è²“å’–ï¼Œå‰›é–‹å§‹æˆ‘ä»¥ç‚ºéƒ½æ˜¯å®…ç”·å»çš„ï¼Œä½†æ²’æƒ³åˆ°è£¡é¢è »ä¹¾æ·¨çš„ä¹ŸçœŸçš„å¥½å¤šå°éš»çš„è²“å’ªè·‘ä¾†è·‘å»ï¼Œçœ‹åˆ°ä½ é–‹å¿ƒç©è²“çš„è‡‰ï¼Œæˆ‘å°±è¦ºå¾—å¾ˆå¹¸ç¦ï¼Œå› ç‚ºæˆ‘åˆå¸¶ä½ å‰µé€ äº†ä¸€å€‹é–‹å¿ƒçš„æ™‚åˆ»ï¼Œæ²’æƒ³åˆ°å¾Œä¾†å› ç‚ºæˆ‘çš„ç–å¿½ï¼Œè®“æˆ‘å€‘è¢«è¿«ä¸­æ­¢æˆ‘å€‘é–‹å¿ƒçš„æ™‚é–“ï¼Œç«‹é¦¬è¶•å›å»æ¡ƒåœ’ã€‚ä½†å¹¸é‹çš„æ˜¯ï¼Œæˆ‘ç­”æ‡‰ä½ çš„äº‹æƒ…é‚„æ˜¯æœ‰åšåˆ°ï¼Œæˆ‘å€‘åˆé–‹ç™¼äº†ä¸€é–“ä¸ä¸€æ¨£çš„æ±½è»Šæ—…é¤¨ï¼(åœ–K)
ç¬¬å…­ç« ï½œä¸€èµ·å‡ºèµ°ï¼šæ—¥æœ¬è¡Œ
7/24æ˜¯æˆ‘æœ€æœ€æœ€æœ€æœ€æœŸå¾…çš„æ—¥å­ï¼Œæ˜¯æˆ‘äººç”Ÿç¬¬ä¸€æ¬¡ç¬¬ä¸€æ¬¡å’Œå¥³æœ‹å‹å‡ºåœ‹ï¼Œé€™æ˜¯æˆ‘å¸Œæœ›åšåˆ°çš„äº‹æƒ…ï¼Œå› ç‚ºæˆ‘èªç‚ºèƒ½è·Ÿå¥³æœ‹å‹å‡ºåœ‹ç©ï¼Œä¸¦ä¸æ˜¯åœ¨åœ‹å…§å¯ä»¥æ¯”æ“¬çš„ï¼Œé™¤äº†è¡Œå‰çš„è¦åŠƒã€å¿ƒç†æº–å‚™æœ€é‡è¦çš„æ˜¯è¦æœ‰ä¸€é¡†é–‹å¿ƒçš„å¿ƒæƒ…ï¼Œæ‰èƒ½å†å‡ºåœ‹çš„æ™‚å€™ä¸ç”Ÿæ°£ã€ä¸åµæ¶é–‹é–‹å¿ƒå¿ƒçµæŸå‡ºåœ‹è¡Œï¼Œåœ¨é€™å¹¾å¤©çš„æ—…é€”ä¸­æˆ‘å€‘æœ‰èªªæœ‰ç¬‘ï¼Œé›–ç„¶æœ‰æ™‚å€™ä½ çš„è¡Œç‚ºçœŸçš„æœƒè®“æˆ‘å¾ˆå‚»çœ¼ä¸çŸ¥é“æ€éº¼èªªï¼Œä½†ç¸½è€Œè¨€ä¹‹æˆ‘å€‘é€™å¹¾å¤©æ˜¯é–‹å¿ƒçš„æ„‰å¿«çš„ï¼Œç˜‹ç‹‚åšæ„›ã€æ‹ç¾ç¾çš„ç…§ç‰‡ã€åƒå¥½åƒçš„æ±è¥¿ä»¥åŠåŠªåŠ›å¤¾äº†ä¸€å€‹ä½ å¾ˆå¸Œæ­¡çš„å¨ƒå¨ƒï¼Œå–”å°äº†ï¼Œæˆ‘å€‘é‚„æœ‰æ‹åˆ°ä½ æœ€æƒ³æ‹çš„ç…§ç‰‡ã€Œå’Œæœã€ï¼Œé›–ç„¶ç•¶ä¸‹æœ‰é»åµæ¶ï¼Œä½†æ˜¯æˆ‘é‚„æ˜¯ç¤ºå¥½é“æ­‰ï¼Œæˆ‘å€‘æœ€å¾Œé‚„æ˜¯é–‹é–‹å¿ƒå¿ƒå›ä¾†å°ç£ã€‚(åœ–L)
ç¬¬ä¸ƒç« ï½œæ…¢æ­¥çš„æ—¥å¸¸
å¾æ—¥æœ¬å›ä¾†å¾Œï¼Œæˆ‘å€‘ç”Ÿæ´»çš„æ­¥èª¿æ¼¸æ¼¸æ…¢äº†ä¸‹ä¾†ï¼Œä½†ä¸è®Šçš„æ˜¯æˆ‘å€‘ä¾èˆŠå»äº†å¥½å¤šåœ°æ–¹å˜—è©¦äº†ä¸ä¸€æ¨£çš„äº‹æƒ…ï¼Œæˆ‘å€‘é–‹å§‹ç©ä¸€äº›å¥½ç©çš„éŠæˆ²ï¼Œåƒæˆ‘å€‘åœ¨ç©æ¨¡æ“¬å¸‚æ°‘çš„æ™‚å€™ä¸€ç›´æƒ³è¦å»æ®ºäººï¼Œé›–ç„¶æˆ‘ä¸€ç›´ç©ä¸æ‡‚è¦æ€éº¼ç©ï¼Œä½†æˆ‘é‚„æ˜¯ç›¡åŠ›å»é™ªä½ ç©ï¼Œå¾Œä¾†æˆ‘å€‘å°±è·‘å»ç©ç…®éé ­ï¼Œé€™å€‹éŠæˆ²ç¶“å¸¸è®“æˆ‘å€‘åµæ¶ï¼Œä½†åŒæ™‚ä¹Ÿå¾ˆå¥½ç©ï¼Œå› ç‚ºçœ‹åˆ°ä½ æˆåŠŸéé—œéƒ½æœƒå¤§å«ï¼Œå°±è¦ºå¾—å¥½åƒæˆ‘ç…®å¤šä¸€é»æ±è¥¿ä¹Ÿæ²’é—œä¿‚ã€‚åœ¨ä½ ç”Ÿç†æœŸçš„æœŸé–“ï¼Œæˆ‘ä¹Ÿå¹«ä½ ç…®äº†å¥½å–çš„ç´…è±†æ¹¯ï¼Œå› ç‚ºæˆ‘çŸ¥é“ä½ ä¸å–œæ­¡åƒåˆ°ç´…è±†ï¼Œæ‰€ä»¥æˆ‘ç‰¹åˆ¥æŠŠè±†å­æ’ˆå‡ºä¾†ï¼Œæˆ‘ä¹Ÿè¨˜å¾—ä½ å–œæ­¡ç”œç”œçš„æ¹¯ï¼Œæ‰€ä»¥æˆ‘åœ¨ç…®çš„æ™‚å€™ä¹Ÿå¤šåŠ äº†ç³–ï¼Œå› ç‚ºä½ è·Ÿæˆ‘èªªéçš„äº‹æƒ…ï¼Œæˆ‘éƒ½æœƒè¨˜å¾—ã€‚å¾Œä¾†çš„æˆ‘å€‘æ„Ÿè¦ºæ…¢æ…¢å¾€å¥½çš„æ–¹å‘ç™¼å±•ï¼Œä½ å¹«æˆ‘åšäº†å¥½å¤šä½ çš„å°å¡ï¼Œæˆ‘ä¹Ÿå¦‚ä½ é¡˜æ”¾åœ¨æˆ‘çš„æ‰‹æ©ŸèƒŒå¾Œï¼Œç­‰æˆ‘é–‹å¿ƒæˆ‘å°±æœƒæ›åœ¨æˆ‘æ›¸åŒ…ä¸Šï¼ï¼ç­”æ‡‰ä½ çš„äº‹æƒ…æˆ‘ä¹Ÿä¾èˆŠæ²’æœ‰å¿˜è¨˜ï¼Œå¾é«˜é›„å›ä¾†å¾Œæˆ‘é¦¬ä¸Šå°±å¸¶ä½ å»åƒå¥½åƒçš„ç©å¥½ç©çš„ï¼Œé‚„è¨˜å¾—é‚£å€‹æ™‚å€™åƒæ·»å¥½é‹ä½ èªªä½ è¦åƒå¥¶çš®ï¼Œæˆ‘å°±è·Ÿåº—å“¡èªªï¼šã€Œä¸å¥½æ„æ€å¥¶çš®æ˜¯ç†±çš„å—ã€ä»–å°±è½ä¸æ‡‚ï¼Œä½ å°±ç¬‘æˆ‘è·Ÿæˆ‘èªªå¥¶çš®æ˜¯ä½ è‡ªå·±å–çš„ï¼Œå®³æˆ‘å°·å°¬äº†å¥½ä¹…ï¼Œä¸Šæ¬¡ç­”æ‡‰ä½ çµ„æ¨‚é«˜å°äººçš„äº‹æƒ…æˆ‘ä¹Ÿæ²’å¿˜è¨˜ï¼Œæˆ‘å°±ä¹–ä¹–çš„å¸¶ä½ å»æ‹¼ï¼Œæˆ‘å€‘æ‹¼å¾—å¥½é–‹å¿ƒï¼Œæ¯æ¬¡è¦ºå¾—çœ‹åˆ°ä½ çš„ç¬‘å®¹å°±è¦ºå¾—å¥½å¹¸ç¦ã€‚(åœ–M)
ä½ æ¯æ¬¡éƒ½èªªæƒ³æˆ‘ï¼Œæœ‰æ™‚å€™çœŸçš„æ²’è¾¦æ³•å»æ¥ä½ çš„æ™‚å€™å°±è¦ºå¾—å¾ˆé›£éï¼Œé€™æ¬¡æˆ‘å°±æ‰“ç®—ç›´æ¥å»æ‰¾ä½ ï¼Œæ´—å®Œæ¾¡æ›å®Œè¡£æœæˆ‘å°±é¦¬ä¸Šå»æ‰¾ä½ ï¼Œå›ä¾†çš„è·¯ä¸Šé‚„é‡åˆ°ç«ç‡’è»Šâ€¦.æˆ‘å€‘é€™å¹¾å¤©éƒ½é–‹é–‹å¿ƒå¿ƒçš„ï¼Œå¸¶ä½ å»å°èŒ‚åƒå¥½åƒçš„æƒ³åˆ°ä½ èªªæƒ³åƒè¾£ï¼ŒäºŒè©±ä¸èªªå°±å¸¶ä½ å»æµ·åº•æ’ˆæ’éšŠï¼Œæ™šä¸Šçš„æˆ‘å€‘ä¹Ÿå¾ˆé–‹å¿ƒçš„çœ‹è‘—é›»å½±ç„¶å¾Œä¸€èµ·å…¥ç¡ã€‚æƒ…äººç¯€ç•¶å¤©ï¼Œæˆ‘ç«Ÿç„¶æ”¶åˆ°ä½ é€æˆ‘çš„ç¦®ç‰©ï¼Œæ˜¯ä¸€å¹…æˆ‘çš„ç•«åƒï¼Œè€å©†ä½ ç•«å¾—å¾ˆåƒéå¸¸åƒçœ‹åˆ°ä½ èªçœŸçš„å°å¾…æˆ‘ï¼ŒèªçœŸçš„æº–å‚™æˆ‘çš„ç¦®ç‰©æˆ‘å°±è¦ºå¾—å¥½é›£éï¼Œæˆ‘å¾ä¾†æ²’æœ‰éç¯€çš„ç¿’æ…£ï¼Œä¹Ÿä¸ç¿’æ…£æ”¶åˆ°ç¦®ç‰©ä½†é€™æ¬¡çš„é©šå–œæ˜¯è®“æˆ‘é–‹å¿ƒçš„ï¼Œä½†åœ¨å‡ºå»ç©çš„éç¨‹ï¼Œå› ç‚ºæˆ‘çš„é—œä¿‚è®“æˆ‘å€‘æœ‰ä¸€é»é»å°å°çš„ä¸æ„‰å¿«ï¼Œç­”æ‡‰ä½ çš„äº‹æƒ…å°±è¦å¥½å¥½åšåˆ°ï¼Œå°ä¸èµ·é€™ä¸€é»æ˜¯æˆ‘çš„å•é¡Œï¼Œæˆ‘ä¸€ç›´è‘—æ€¥å›å»å®¶è£¡ï¼Œæƒ³å¥½å¥½ä¼‘æ¯ï¼Œä½†æˆ‘ç™¼ç¾ä½ çœŸçš„éå¸¸éœ€è¦ï¼Œæˆ‘çŸ¥é“éŒ¯äº†è€å©†ã€‚(åœ–N)
çµ‚ç« ï½œæˆ‘å€‘ä»¥å¾Œ
å›é ­çœ‹ï¼Œæˆ‘å€‘å·²ç¶“ä¸€èµ·èµ°éäº†å…©ç™¾äº”åå¤šå€‹æ—¥å­ã€‚å¾é™Œç”Ÿã€æ›–æ˜§ï¼Œåˆ°å¦‚ä»Šç‰½è‘—æ‰‹ä¸€åŒé¢å°ç”Ÿæ´»çš„å¤§å°äº‹ï¼Œæ¯ä¸€æ®µå›æ†¶éƒ½è®“æˆ‘æ›´ç¢ºå®šâ€”â€”æˆ‘æƒ³å’Œä½ ä¸€èµ·èµ°å¾ˆé å¾ˆé çš„è·¯ã€‚
æœªä¾†æˆ‘å€‘é‚„æœƒé‡åˆ°è¨±å¤šé–‹å¿ƒçš„äº‹ï¼Œä¹Ÿä¸€å®šæœƒæœ‰åµæ¶ã€æœ‰èª¤è§£ã€æœ‰çœ¼æ·šã€‚ä½†å°±åƒéå»çš„æˆ‘å€‘é‚£æ¨£ï¼Œæˆ‘å€‘æœƒå­¸æœƒå¥½å¥½èªªè©±ã€å¥½å¥½å‚¾è½ã€å¥½å¥½ç›¸æ„›ã€‚
è¬è¬ä½ é¸æ“‡äº†æˆ‘ï¼Œä¹Ÿè®“æˆ‘æœ‰æ©Ÿæœƒå»å­¸ç¿’å¦‚ä½•æˆç‚ºä¸€å€‹æ›´å¥½çš„äººã€‚
é¡˜æˆ‘å€‘æœªä¾†çš„æ¯ä¸€å°ä¿¡ã€æ¯ä¸€å¼µåˆç…§ã€æ¯ä¸€å€‹æ“æŠ±ï¼Œéƒ½æˆç‚ºé€™æœ¬æ•…äº‹æ›¸ç¹¼çºŒå¾€ä¸‹å¯«çš„å‹•åŠ›ã€‚
æˆ‘å€‘çš„æ•…äº‹ï¼Œé‚„æ²’å®Œï¼Œé‚„æœƒç¹¼çºŒå¯«ä¸‹å»ã€‚
è€Œæˆ‘ï¼Œæœƒæ°¸é æ˜¯ä½ èº«é‚Šæœ€çœŸèª ã€æœ€æ„›ä½ çš„é‚£å€‹äººã€‚

`,
  randomLines: [
    "",
    "è·¯éå¾ˆå¤šå…‰ï¼Œé‚„æ˜¯ä½ çš„çœ¼ç›æœ€äº®ã€‚",
    "æƒ³æŠŠå¹³å‡¡éæˆç¯€æ—¥ã€‚",
    "é¢¨æŠŠè©±å¹å¾—å¾ˆæ…¢ï¼Œæˆ‘æŠŠä½ è½å¾—å¾ˆèªçœŸã€‚",
  ],
};
// ==============================================================

type Stage = "envelope" | "box" | "letters" | "novel" | "finale";

// ===================== é€šç”¨å°å·¥å…· =====================
function useLongPress(callback: () => void, delay = 1000) {
  // ç”¨å…¨åŸŸ setTimeout çš„å›å‚³å‹åˆ¥ï¼Œè·¨ç’°å¢ƒæœ€ä¸æœƒåµ
  const timer = useRef<ReturnType<typeof setTimeout> | null>(null);

  const start = () => {
    if (timer.current) return;
    // æ³¨æ„ï¼šé€™è£¡ä¸è¦åŠ  window.
    timer.current = setTimeout(() => {
      callback();
      timer.current = null;
    }, delay);
  };

  const clear = () => {
    if (timer.current) {
      // åŒç†ï¼Œç”¨ clearTimeoutï¼ˆä¸è¦åŠ  window.ï¼‰
      clearTimeout(timer.current);
      timer.current = null;
    }
  };

  return { start, clear };
}



// ===================== èŠ±ç“£èƒŒæ™¯ï¼ˆCanvasï¼‰ =====================
function PetalsBackground({ active }: { active: boolean }) {
  const ref = useRef<HTMLCanvasElement | null>(null);
  useEffect(() => {
    if (!active) return;
    const canvas = ref.current!;
    const ctx = canvas.getContext("2d")!;
    const dpr = Math.min(window.devicePixelRatio || 1, 2);

    const resize = () => {
      const { innerWidth: w, innerHeight: h } = window;
      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      canvas.style.width = w + "px";
      canvas.style.height = h + "px";
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    };
    resize();
    window.addEventListener("resize", resize);

    const count = 18;
    const petals = Array.from({ length: count }).map(() => ({
      x: Math.random() * window.innerWidth,
      y: Math.random() * -window.innerHeight,
      r: 6 + Math.random() * 10,
      vx: -0.6 + Math.random() * 1.2,
      vy: 0.8 + Math.random() * 1.2,
      rot: Math.random() * Math.PI,
      vr: -0.01 + Math.random() * 0.02,
      hue: 340 + Math.random() * 20,
    }));

    let raf = 0;
    const draw = () => {
      const w = canvas.width / dpr;
      const h = canvas.height / dpr;
      ctx.clearRect(0, 0, w, h);
      petals.forEach((p) => {
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        if (p.y - p.r > h) {
          p.x = Math.random() * w;
          p.y = -20;
        }
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = `hsla(${p.hue},60%,70%,0.8)`;
        ctx.beginPath();
        ctx.ellipse(0, 0, p.r, p.r * 0.6, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
      });
      raf = requestAnimationFrame(draw);
    };
    draw();

    return () => {
      cancelAnimationFrame(raf);
      window.removeEventListener("resize", resize);
    };
  }, [active]);

  return <canvas ref={ref} className="fixed inset-0 -z-10" aria-hidden />;
}

// ===================== éš¨æ©Ÿè©©å¥æµ®ç¾ï¼ˆå½©è›‹ï¼‰ =====================
function PoemPopper({ lines, active }: { lines: string[]; active: boolean }) {
  const [items, setItems] = useState<{ id: number; x: number; y: number; text: string }[]>([]);
  useEffect(() => {
    if (!active) return;
    let id = 0;
    const onClick = (e: MouseEvent) => {
      const t = lines[Math.floor(Math.random() * lines.length)] || "";
      setItems((prev) => [...prev, { id: id++, x: e.clientX, y: e.clientY, text: t }]);
      setTimeout(() => setItems((prev) => prev.slice(1)), 1600);
    };
    window.addEventListener("click", onClick);
    return () => window.removeEventListener("click", onClick);
  }, [lines, active]);

  if (!active) return null;
  return (
    <div className="pointer-events-none fixed inset-0 z-40">
      {items.map((it) => (
        <span
          key={it.id}
          className="absolute text-sm sm:text-base text-rose-700/90 bg-white/80 backdrop-blur px-2 py-1 rounded-lg shadow transition-opacity duration-700 animate-fadeUp"
          style={{ left: it.x, top: it.y }}
        >
          {it.text}
        </span>
      ))}
      <style>{`
        @keyframes fadeUp { 0%{opacity:0; transform:translate(-50%,-10px)} 20%{opacity:1; transform:translate(-50%,-18px)} 100%{opacity:0; transform:translate(-50%,-44px)} }
        .animate-fadeUp{ animation: fadeUp 1.4s ease-out forwards; transform: translate(-50%,-44px); }
      `}</style>
    </div>
  );
}

// ===================== ç…™ç«ï¼ˆCanvasï¼‰ =====================
function Fireworks({ active }: { active: boolean }) {
  const ref = useRef<HTMLCanvasElement | null>(null);
  useEffect(() => {
    if (!active) return;
    const canvas = ref.current!;
    const ctx = canvas.getContext("2d")!;
    const dpr = Math.min(window.devicePixelRatio || 1, 2);

    const resize = () => {
      const { innerWidth: w, innerHeight: h } = window;
      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      canvas.style.width = w + "px";
      canvas.style.height = h + "px";
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    };
    resize();
    window.addEventListener("resize", resize);

    type Particle = { x: number; y: number; vx: number; vy: number; life: number; color: string };
    const particles: Particle[] = [];

    const spawnFirework = (x: number, y: number) => {
      const n = 60;
      const hue = Math.floor(200 + Math.random() * 100);
      for (let i = 0; i < n; i++) {
        const angle = (i / n) * Math.PI * 2;
        const speed = 2 + Math.random() * 3.2;
        particles.push({
          x,
          y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: 1,
          color: `hsl(${hue + Math.random() * 40}, 80%, 60%)`,
        });
      }
    };

    const autoTimer = setInterval(() => {
      spawnFirework(window.innerWidth * (0.3 + Math.random() * 0.4), window.innerHeight * (0.35 + Math.random() * 0.2));
    }, 1300);

    const onClick = (e: MouseEvent) => spawnFirework(e.clientX, e.clientY);
    window.addEventListener("click", onClick);

    let raf = 0;
    const draw = () => {
      const w = canvas.width / dpr;
      const h = canvas.height / dpr;
      ctx.fillStyle = "rgba(0,0,0,0.25)";
      ctx.fillRect(0, 0, w, h);

      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.vy += 0.02;
        p.x += p.vx;
        p.y += p.vy;
        p.life -= 0.012;
        if (p.life <= 0) {
          particles.splice(i, 1);
          continue;
        }
        ctx.globalAlpha = Math.max(p.life, 0);
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.fill();
      }

      raf = requestAnimationFrame(draw);
    };
    draw();

    return () => {
      cancelAnimationFrame(raf);
      window.removeEventListener("resize", resize);
      window.removeEventListener("click", onClick);
      clearInterval(autoTimer);
    };
  }, [active]);

  return <canvas ref={ref} className="fixed inset-0 -z-10" aria-hidden />;
}

// ===================== ä¸»é é¢ =====================
export default function Page() {
  // 1) å…¨åŸŸæµç¨‹ç‹€æ…‹ï¼ˆå…ˆå®£å‘Šï¼‰
  const [stage, setStage] = useState<Stage>("envelope");

  // 2) çŸ­ç¯‡ç´¢å¼• + å‹•ç•«æ–¹å‘/éµï¼ˆåªå®£å‘Šä¸€æ¬¡ï¼‰
  const [idx, setIdx] = useState(0);
  const [animKey, setAnimKey] = useState(0);
  const [dir, setDir] = useState<"fwd" | "back">("fwd");

  // 3) è§¸æ§æ»‘å‹•ï¼ˆref ä¸æœƒç ´å£ hooks é †åºï¼‰
  const startX = useRef<number | null>(null);
  const startY = useRef<number | null>(null);
  const SWIPE_THRESHOLD = 48;

  const goNext = () => {
    if (idx < config.letters.length - 1) {
      setDir("fwd");
      setIdx(i => i + 1);
      setAnimKey(k => k + 1);
    } else {
      setDir("fwd");
      setAnimKey(k => k + 1);
      setStage("novel");
    }
  };

  const goPrev = () => {
    if (idx > 0) {
      setDir("back");
      setIdx(i => i - 1);
      setAnimKey(k => k + 1);
    }
  };

  const onTouchStart = (e: React.TouchEvent) => {
    const t = e.changedTouches[0];
    startX.current = t.clientX;
    startY.current = t.clientY;
  };

  const onTouchEnd = (e: React.TouchEvent) => {
    const t = e.changedTouches[0];
    if (startX.current == null || startY.current == null) return;
    const dx = t.clientX - startX.current;
    const dy = t.clientY - startY.current;
    if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > SWIPE_THRESHOLD) {
      if (dx < 0) goNext(); else goPrev();
    }
    startX.current = null;
    startY.current = null;
  };

  // 4) éµç›¤å¿«æ·ï¼ˆå¯é¸ï¼‰
  useEffect(() => {
    const onKey = (e: KeyboardEvent) => {
      if (stage !== "letters") return;
      if (e.key === "ArrowRight") goNext();
      if (e.key === "ArrowLeft") goPrev();
    };
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, [idx, stage]);

  // 5) box éšæ®µï¼ˆé•·æŒ‰æ‹†ç·å¸¶ï¼‰
  const [unboxed, setUnboxed] = useState(false);
  const { start, clear } = useLongPress(() => setUnboxed(true), 900);
  useEffect(() => {
    if (stage === "box" && unboxed) {
      const t = setTimeout(() => setStage("letters"), 600);
      return () => clearTimeout(t);
    }
  }, [stage, unboxed]);

  // 6) novel éšæ®µï¼ˆé•·ç¯‡ï¼‰æ»¾å‹•é€²åº¦
  const wrapRef = useRef<HTMLDivElement | null>(null);
  const [progress, setProgress] = useState(0);
  useEffect(() => {
    if (stage !== "novel") return;
    const el = wrapRef.current;
    if (!el) return;
    const onScroll = () => {
      const max = el.scrollHeight - el.clientHeight;
      const pct = max > 0 ? Math.min(100, Math.max(0, (el.scrollTop / max) * 100)) : 0;
      setProgress(pct);
    };
    el.addEventListener("scroll", onScroll);
    return () => el.removeEventListener("scroll", onScroll);
  }, [stage]);

  // 7) æ°›åœç‰¹æ•ˆé–‹é—œ
  const petalsOn = stage === "envelope" || stage === "box" || stage === "letters";
  const poemsOn = stage === "letters";

// ===== Novel è®€æ›¸å™¨ï¼šç‹€æ…‹ =====
const [lightbox, setLightbox] = useState<{ open: boolean; src: string; alt?: string; caption?: string }>({ open: false, src: "" });
const [fontScale, setFontScale] = useState(1);            // 1, 1.1, 1.2 ...
const [serif, setSerif] = useState(true);                 // è¥¯ç·šå­—é«”åˆ‡æ›
const [darkRead, setDarkRead] = useState(false);          // å¤œé–“æ¨¡å¼
const [savedScroll, setSavedScroll] = useState<number | null>(null);

// å­—æ•¸/åˆ†é˜ä¼°ç®—ï¼ˆä¸­æ–‡ç”¨å»ç©ºç™½çš„å­—å…ƒæ•¸ï¼›ç´„ 300 å­—/åˆ†é˜ï¼‰
const charCount = React.useMemo(
  () => config.longLetter.replace(/\s/g, "").length,
  []
);
const estMinutes = Math.max(1, Math.round(charCount / 300));

// é€²å…¥ novel æ™‚ï¼Œå˜—è©¦è®€å–ä¸Šæ¬¡é€²åº¦
useEffect(() => {
  if (stage !== "novel") return;
  const k = "novelScrollTop";
  const v = Number(localStorage.getItem(k) || "0");
  if (!Number.isNaN(v) && v > 30) setSavedScroll(v);
}, [stage]);

// novel æ»¾å‹•æ™‚ï¼Œå„²å­˜é€²åº¦ï¼ˆæ²¿ç”¨ä½ å·²æœ‰çš„ wrapRef / progressï¼‰
useEffect(() => {
  if (stage !== "novel") return;
  const el = wrapRef.current;
  if (!el) return;
  const onScroll = () => {
    const max = el.scrollHeight - el.clientHeight;
    const pct = max > 0 ? Math.min(100, Math.max(0, (el.scrollTop / max) * 100)) : 0;
    setProgress(pct);
    localStorage.setItem("novelScrollTop", String(el.scrollTop));
  };
  el.addEventListener("scroll", onScroll);
  return () => el.removeEventListener("scroll", onScroll);
}, [stage]);

// æŒ‰ã€Œç¹¼çºŒé–±è®€ã€æ™‚å›åˆ°ä¸Šæ¬¡ä½ç½®
const resumeReading = () => {
  const el = wrapRef.current;
  if (el && savedScroll) {
    el.scrollTo({ top: savedScroll, behavior: "instant" as ScrollBehavior });
    setSavedScroll(null);
  }
};

  // ====== Stage 1: ä¿¡å°é–‹å ´ ======
  if (stage === "envelope") {
    return (
      <main className="min-h-screen flex items-center justify-center bg-gradient-to-b from-rose-50 to-pink-100 relative overflow-hidden">
        <PetalsBackground active={petalsOn} />
        <div className="text-center space-y-3 absolute top-8 left-1/2 -translate-x-1/2">
          <p className="text-xs uppercase tracking-widest text-rose-600/80">for {config.loverName}</p>
          <h1 className="text-2xl sm:text-3xl font-bold text-rose-700">æœ‰ä¸€å°ä¿¡æƒ³äº¤åˆ°ä½ æ‰‹ä¸Š</h1>
        </div>
        <button
          aria-label="open envelope"
          onClick={() => setStage("box")}
          className="relative w-[320px] h-[200px] rounded-lg shadow-2xl overflow-hidden border border-rose-200 active:scale-95 transition"
        >
          <div className="absolute inset-0 bg-rose-200" />
          <div className="absolute inset-0 origin-top rotate-12 bg-rose-300/90" />
          <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-rose-500 shadow-inner flex items-center justify-center text-white">â™¥</div>
          <span className="absolute bottom-3 w-full text-center text-sm font-medium text-rose-900"></span>
        </button>
      </main>
    );
  }

  // ====== Stage 2: ç¦®ç›’ï¼ˆé•·æŒ‰æ‹†ç·å¸¶ï¼‰ ======
  if (stage === "box") {
    return (
      <main className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-pink-100 to-rose-50 relative overflow-hidden">
        <PetalsBackground active={petalsOn} />
        <h2 className="mb-6 text-2xl font-bold text-rose-700">æ‹†é–‹å°ç¦®ç›’</h2>
        <div className="relative w-44 h-44">
          <div className="absolute inset-0 bg-yellow-300 rounded-lg shadow-xl border border-yellow-200" />
          <div className={`absolute left-0 right-0 top-1/2 -translate-y-1/2 h-8 bg-red-500 transition ${unboxed ? "opacity-0" : "opacity-100"}`} />
          <div className={`absolute top-0 bottom-0 left-1/2 -translate-x-1/2 w-8 bg-red-500 transition ${unboxed ? "opacity-0" : "opacity-100"}`} />
          <div className={`absolute inset-3 bg-white rounded-md grid place-items-center text-3xl transition-transform ${unboxed ? "-translate-y-8 opacity-100" : "translate-y-0 opacity-90"}`}>ğŸ´</div>
        </div>
        <p className="mt-4 text-rose-700">{unboxed ? "æ‰“é–‹ä¸­â€¦" : "é•·æŒ‰ 1 ç§’æ‹†é–‹ç·å¸¶"}</p>
        <button
          onMouseDown={start}
          onMouseUp={clear}
          onMouseLeave={clear}
          onTouchStart={start}
          onTouchEnd={clear}
          className="mt-4 px-4 py-2 rounded-lg bg-rose-500 text-white shadow hover:bg-rose-600"
        >
          â™¥ é•·æŒ‰
        </button>
      </main>
    );
  }

  // ====== Stage 3: çŸ­ç¯‡ä¿¡ä»¶ï¼ˆæ–‡å­— + ç…§ç‰‡ + å½©è›‹è©©å¥ï¼‰ ======
// ====== Stage 3: çŸ­ç¯‡ä¿¡ä»¶ï¼ˆæ»‘å‹•ç¿»é  + æ–¹å‘å‹•ç•«ï¼‰ ======
if (stage === "letters") {
  const L = config.letters[idx];
  const hasNext = idx < config.letters.length - 1;

  return (
    <main
      className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-white to-rose-50 p-6 relative overflow-hidden"
      onTouchStart={onTouchStart}
      onTouchEnd={onTouchEnd}
    >
      <PetalsBackground active={true} />

      {/* å³ä¸Šè§’é€²åº¦ */}
      <div className="absolute top-4 right-4 text-xs text-rose-600/80 bg-white/70 backdrop-blur px-2 py-1 rounded-md shadow-sm">
        {idx + 1} / {config.letters.length}
      </div>

      {/* ä¿¡ä»¶å¡ç‰‡ï¼šä¾æ–¹å‘å¥—ä¸åŒå‹•ç•« */}
      <div
        key={animKey}
        className={`max-w-xl w-full bg-white rounded-2xl shadow-lg border border-rose-100 p-6 text-center relative z-10
          ${dir === "fwd" ? "animate-pageNext" : "animate-pagePrev"} will-change-transform`}
      >
        <p className="text-lg leading-relaxed whitespace-pre-line text-gray-800">{L.text}</p>

        {L.img && (
          <div className="mt-4">
            {/* eslint-disable-next-line @next/next/no-img-element */}
            <img
              src={L.img}
              alt="memory"
              className="mx-auto w-[58%] max-w-xs h-auto rounded-xl shadow-md object-cover"
            />
            <p className="mt-2 text-xs text-gray-500">ï¼ˆå·¦å³æ»‘å‹•å¯ç¿»é ï¼‰</p>
          </div>
        )}
      </div>

      {/* æŒ‰éˆ•ï¼ˆä»ç„¶ä¿ç•™ï¼‰ */}
      <div className="mt-6 z-10 flex gap-3">
        {idx > 0 && (
          <button
            onClick={goPrev}
            className="px-4 py-2 rounded-lg bg-rose-200 text-rose-800 shadow hover:bg-rose-300"
          >
            â† ä¸Šä¸€å°
          </button>
        )}
        {hasNext ? (
          <button
            onClick={goNext}
            className="px-4 py-2 rounded-lg bg-rose-500 text-white shadow hover:bg-rose-600"
          >
            ä¸‹ä¸€å° â†’
          </button>
        ) : (
          <button
            onClick={() => setStage("novel")}
            className="px-4 py-2 rounded-lg bg-indigo-500 text-white shadow hover:bg-indigo-600"
          >
            é€²å…¥é•·ç¯‡ ğŸ“–
          </button>
        )}
      </div>

      {/* æ–¹å‘æ„Ÿå‹•ç•«ï¼šåƒç¿»é æ»‘å…¥ */}
      <style>{`
        @keyframes pageNext {
          0%   { opacity: 0; transform: perspective(900px) rotateY(-8deg) translateX(24px) translateY(8px) scale(.98); }
          60%  { opacity: 1; transform: perspective(900px) rotateY(-1.5deg) translateX(0) translateY(0) scale(1.006); }
          100% { opacity: 1; transform: perspective(900px) rotateY(0deg) translateX(0) translateY(0) scale(1); }
        }
        @keyframes pagePrev {
          0%   { opacity: 0; transform: perspective(900px) rotateY(8deg) translateX(-24px) translateY(8px) scale(.98); }
          60%  { opacity: 1; transform: perspective(900px) rotateY(1.5deg) translateX(0) translateY(0) scale(1.006); }
          100% { opacity: 1; transform: perspective(900px) rotateY(0deg) translateX(0) translateY(0) scale(1); }
        }
        .animate-pageNext { animation: pageNext .46s cubic-bezier(.2,.7,.2,1) both; }
        .animate-pagePrev { animation: pagePrev .46s cubic-bezier(.2,.7,.2,1) both; }
      `}</style>
    </main>
  );
}



// ====== Stage 4: é•·ç¯‡å°èªªï¼ˆè‡ªå‹•æŠŠ longLetter è½‰æˆæ•…äº‹æ›¸ + åœ–ç‰‡æ¨™è¨˜ï¼‰ ======
if (stage === "novel") {
  const canUnlockFinale = progress >= 85;

  // ä½ åªéœ€è¦æ”¹é€™å¼µè¡¨ï¼šæŠŠæ¯å€‹åœ–çš„ src/caption/span æ›æˆä½ çš„å¯¦éš›è·¯å¾‘èˆ‡åœ–èªª
  // span: "narrow"ï¼ˆé è¨­å¡ç‰‡å¯¬ï¼‰ã€"wide"ï¼ˆè¼ƒå¯¬ï¼‰ã€"full"ï¼ˆæ»¿ç‰ˆï¼‰
  const imageMap: Record<string, { src: string; alt?: string; caption?: string; span?: "narrow" | "wide" | "full" }> = {
    A: { src: "/photos/A.jpg", caption: "é è¿‘ï¼Œæ˜¯æŠŠå¿ƒæ”¾åˆ°åŒä¸€å´ã€‚", span: "narrow" },
    B: { src: "/photos/B.jpg", caption: "ä½ çš„èƒŒå½±ä¾èˆŠå¾ˆå¥½çœ‹", span: "narrow" },
    C: { src: "/photos/C.jpg", caption: "ä½ èªªã€Œæˆ‘é¡˜æ„ã€çš„é‚£ä¸€åˆ»ï¼Œæˆ‘è´äº†ã€‚", span: "narrow" },
    D: { src: "/photos/D.jpg", caption: "åœ¨æµ·é‚Šçœ‹è‘—å¤•é™½ï¼Œè®“æˆ‘æƒ³åˆ°äº†äº”åå¹´å¾Œèº«æ—çš„ä½ ã€‚", span: "narrow" },
    E: { src: "/photos/E.jpg", caption: "å­¸æœƒéä½ çš„ç¯€æ—¥ï¼Œæ˜¯æˆ‘æ–°çš„ä½œæ¥­ã€‚", span: "narrow" },
    F: { src: "/photos/F.jpg", caption: "çœ‹åˆ°ä½ ç¬‘çš„æ™‚å€™ï¼Œæˆ‘æ˜¯é€™ä¸–ç•Œä¸Šæœ€å¹¸ç¦çš„ç”·äººã€‚", span: "narrow" },
    G: { src: "/photos/G.jpg", caption: "åœ¨ä½ ç¬‘çš„æ™‚å€™ï¼Œæˆ‘æ‰€æœ‰çš„ç–²æ†Šéƒ½æ­¸é›¶ã€‚", span: "narrow" },
    H: { src: "/photos/H.jpg", caption: "è¬è¬ä½ çµ¦æˆ‘çš„é©šå–œï¼Œæˆ‘äººç”Ÿçš„ç¬¬ä¸€æ¬¡çµ¦äº†ä½ ã€‚", span: "narrow" },
    I: { src: "/photos/I.jpg", caption: "ä¸å®Œç¾çš„ä¸€å¤©ï¼Œå› ç‚ºä½ çš„é™ªä¼´è®“å®ƒéå»ã€‚", span: "narrow" },
    J: { src: "/photos/J.jpg", caption: "æˆ‘æ„›çš„äººï¼Œä¹Ÿæœ‰å¥¹å¯æ„›çš„ä¾†è™•ã€‚", span: "narrow" },
    K: { src: "/photos/K.jpg", caption: "è¢«æ‰“æ–·çš„å¿«æ¨‚ï¼Œä¹Ÿæœƒåœ¨ä¸‹æ¬¡æ¥çºŒã€‚", span: "narrow" },
    L: { src: "/photos/L.jpg", caption: "çœ‹è‘—æˆ‘å€‘å’Œæœçš„æ¨£å­ï¼Œå¯¦åœ¨æ˜¯èˆ¬é…", span: "narrow" },
    M: { src: "/photos/M.jpg", caption: "ä¸€èµ·ç ´é—œï¼Œæ¯”ä¸€å€‹äººè´æ›´å¿«æ¨‚ã€‚", span: "narrow" },
    N: { src: "/photos/N.jpg", caption: "æˆ‘æƒ³ä½ æ™‚ï¼Œè·¯å°±ä¸é äº†ã€‚", span: "narrow" },
  };

  // è§£æå™¨ï¼šæŠŠ longLetter -> blocksï¼ˆç« ç¯€ / æ®µè½ / åœ–ç‰‡ / åˆ†éš”ç·š / å¼•è¨€ï¼‰
  type Block =
    | { type: "chapter"; title: string }
    | { type: "p"; text: string }
    | { type: "img"; src: string; alt?: string; caption?: string; span?: "narrow" | "wide" | "full" }
    | { type: "divider" }
    | { type: "quote"; text: string };

  const parseLongLetterToBlocks = (raw: string): Block[] => {
    const lines = raw.split(/\r?\n/).map(l => l.trim());
    const blocks: Block[] = [];
    let inPrologue = false;

    const pushDivider = () => {
      if (blocks.length && blocks[blocks.length - 1]?.type !== "divider") {
        blocks.push({ type: "divider" });
      }
    };

    for (const line of lines) {
      if (!line) continue;

      if (line === "é¡Œè¨˜") {
        if (blocks.length) pushDivider();
        blocks.push({ type: "chapter", title: "é¡Œè¨˜" });
        inPrologue = true;
        continue;
      }

      // ç« ç¯€ï¼ˆå«çµ‚ç« ï¼‰
      const chapMatch = line.match(/^(ç¬¬.+?ç« ï½œ.*|çµ‚ç« ï½œ.*)$/);
      if (chapMatch) {
        pushDivider();
        blocks.push({ type: "chapter", title: chapMatch[1] });
        inPrologue = false;
        continue;
      }

      // æŠŠï¼ˆåœ–Xï¼‰æ¨™è¨˜æŠ½å‡ºï¼Œåˆ†æ®µ + æ’å…¥åœ–ç‰‡
      // æ”¯æ´å…¨å½¢/åŠå½¢æ‹¬è™Ÿ
      const imgTagRegex = /ï¼ˆåœ–([A-Z])ï¼‰|\(åœ–([A-Z])\)/g;
      let lastIndex = 0;
      let m: RegExpExecArray | null;
      let hasImageInLine = false;

      while ((m = imgTagRegex.exec(line)) !== null) {
        hasImageInLine = true;
        const before = line.slice(lastIndex, m.index).trim();
        if (before) blocks.push({ type: "p", text: before });

        const key = (m[1] || m[2]) as string;
        const meta = imageMap[key];
        if (meta) {
          blocks.push({ type: "img", src: meta.src, alt: meta.alt, caption: meta.caption, span: meta.span || "narrow" });
        }
        lastIndex = m.index + m[0].length;
      }

      const tail = line.slice(lastIndex).trim();
      if (tail) {
        // æŠŠã€Œå¤ªç›´ç™½ã€çš„èªå¥åšæº«æŸ”åŒ–ï¼ˆåªé‡å°å¸¸è¦‹ä¸€å…©å¥ï¼‰
        const softened = tail.replace(/ç˜‹ç‹‚åšæ„›/g, "è‚†ç„¡å¿Œæ†šåœ°ç›¸æ„›");
        blocks.push({ type: "p", text: softened });
      }

      // é¡Œè¨˜çµå°¾åŠ ä¸€å¥å¼•è¨€ï¼ˆå¯é¸ï¼‰
      if (inPrologue && line.includes("çè²´")) {
        blocks.push({ type: "quote", text: "è¬è¬ä½ é¸æ“‡æˆ‘ï¼Œè®“æˆ‘æ„›ä¸Šä½ ã€‚" });
        inPrologue = false;
      }
    }

    return blocks;
  };

  const blocks = parseLongLetterToBlocks(config.longLetter);

  // å°å…ƒä»¶ï¼šæ¸²æŸ“å€å¡Šï¼ˆç„¡ hooksï¼‰
  const StoryBlock = ({ b }: { b: Block }) => {
    switch (b.type) {
      case "chapter":
        return (
          <div className="my-6">
            <h2 className="text-2xl sm:text-3xl font-bold tracking-wide">{b.title}</h2>
          </div>
        );
      case "p":
        return <p className="my-4 leading-8">{b.text}</p>;
      case "quote":
        return (
          <blockquote className="my-6 p-4 sm:p-5 rounded-2xl bg-rose-50 border border-rose-100 text-rose-900/90 italic">
            {b.text}
          </blockquote>
        );
      case "divider":
        return <hr className="my-8 border-rose-100" />;
      case "img": {
        const span = b.span || "narrow";
        const wrapper =
          span === "full" ? "max-w-none -mx-6 sm:-mx-7" :
          span === "wide" ? "max-w-4xl" :
          "max-w-2xl";
        return (
          <figure className={`my-5 ${wrapper}`}>
            {/* eslint-disable-next-line @next/next/no-img-element */}
            <img
              src={b.src}
              alt={b.alt || "photo"}
              className={`w-full h-auto rounded-2xl shadow-md object-cover cursor-zoom-in ${
                span === "full" ? "max-h-[56vh] object-cover" : ""
              }`}
              onClick={() => setLightbox({ open: true, src: b.src, alt: b.alt, caption: b.caption })}
            />
            {b.caption && <figcaption className="text-xs text-gray-500 mt-2">{b.caption}</figcaption>}
          </figure>
        );
      }
      default:
        return null;
    }
  };

  return (
    <main className={`min-h-screen p-0 ${darkRead ? "bg-[#0e0e10] text-[#f3f4f6]" : "bg-rose-50 text-gray-800"}`}>
      {/* ç½®é ‚å·¥å…·åˆ—ï¼ˆæ²¿ç”¨ä½ åŸæœ¬çš„ï¼‰ */}
      <div className={`sticky top-0 z-20 border-b ${darkRead ? "border-white/10 bg-black/60" : "border-rose-100 bg-white/80"} backdrop-blur`}>
        <div className={`${darkRead ? "bg-white/10" : "bg-rose-100"} h-1`}>
          <div className={`${darkRead ? "bg-white" : "bg-rose-500"} h-full`} style={{ width: `${progress}%` }} />
        </div>
        <div className="max-w-3xl mx-auto flex items-center justify-between px-4 py-3">
          <div className="text-sm opacity-80">ç´„ {estMinutes} åˆ†é˜è®€å®Œ Â· å·²è®€ {Math.round(progress)}%</div>
          <div className="flex items-center gap-2">
            <button onClick={() => setSerif(s => !s)} className="px-2 py-1 text-sm rounded border border-gray-200 hover:bg-gray-50 dark:hover:bg-white/10" title="è¥¯ç·š/ç„¡è¥¯ç·š">
              {serif ? "Serif" : "Sans"}
            </button>
            <button onClick={() => setFontScale(s => Math.max(0.9, Math.round((s - 0.1) * 10) / 10))} className="px-2 py-1 text-sm rounded border border-gray-200 hover:bg-gray-50 dark:hover:bg-white/10" title="ç¸®å°å­—ç´š">A-</button>
            <button onClick={() => setFontScale(s => Math.min(1.6, Math.round((s + 0.1) * 10) / 10))} className="px-2 py-1 text-sm rounded border border-gray-200 hover:bg-gray-50 dark:hover:bg-white/10" title="æ”¾å¤§å­—ç´š">A+</button>
            <button onClick={() => setDarkRead(d => !d)} className="px-2 py-1 text-sm rounded border border-gray-200 hover:bg-gray-50 dark:hover:bg-white/10" title="å¤œé–“æ¨¡å¼">
              {darkRead ? "â˜€ï¸" : "â˜¾"}
            </button>
          </div>
        </div>
      </div>

      {/* å…§æ–‡ï¼šå·²è§£æçš„æ•…äº‹æ›¸å€å¡Šï¼ˆå¯æ»¾å‹•ã€å¯æ”¾å¤§åœ–ç‰‡ï¼‰ */}
      <div className="max-w-3xl mx-auto px-5 sm:px-6 py-6 sm:py-8">
        {savedScroll !== null && (
          <div className={`mb-4 text-sm ${darkRead ? "text-white/80" : "text-gray-600"}`}>
          </div>
        )}

        <div
          ref={wrapRef}
          className={`bg-white ${darkRead ? "!bg-[#0b0b0c] !text-[#f3f4f6] border-white/10" : "border-rose-100"}
                      rounded-2xl shadow-lg border overflow-y-auto max-h-[74vh]
                      px-6 sm:px-7 py-6 selection:bg-rose-200/60`}
          style={{
            fontFamily: serif ? `"Noto Serif TC", ui-serif, serif` : `"Noto Sans TC", ui-sans-serif, system-ui, -apple-system, Segoe UI`,
            fontSize: `${16 * fontScale}px`,
            lineHeight: 1.75,
          }}
        >
          <div className="prose prose-neutral max-w-none dark:prose-invert">
            {blocks.map((b, i) => <StoryBlock key={i} b={b} />)}
          </div>
        </div>

        {/* åº•éƒ¨æ“ä½œï¼ˆæ²¿ç”¨ï¼‰ */}
        <div className="mt-5 flex flex-wrap gap-3 items-center">
          <button
            onClick={() => setStage("letters")}
            className={`px-4 py-2 rounded-lg ${darkRead ? "bg-white/10 border border-white/20 hover:bg-white/15" : "bg-rose-200 text-rose-800 hover:bg-rose-300"} shadow`}
          >
            å›åˆ°çŸ­ç¯‡
          </button>

          <button
            onClick={() => setStage("finale")}
            disabled={!canUnlockFinale}
            className={`px-4 py-2 rounded-lg shadow text-white ${canUnlockFinale ? "bg-indigo-500 hover:bg-indigo-600" : "bg-indigo-300 cursor-not-allowed"}`}
            title={canUnlockFinale ? "" : "è®€åˆ° 85% æœƒè‡ªå‹•è§£é–"}
          >
            çœ‹æœ€å¾Œçš„é©šå–œ âœ¨
          </button>

          <span className={`text-xs ${darkRead ? "text-white/60" : "text-gray-500"}`}>
            {canUnlockFinale ? "å·²è§£é–" : "å·²è®€æ»¿ 85% å³è§£é–"}
          </span>
        </div>
      </div>

      {/* Lightbox æ”¾å¤§åœ– */}
      {lightbox.open && (
        <div
          className="fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4"
          onClick={() => setLightbox({ open: false, src: "" })}
        >
          {/* eslint-disable-next-line @next/next/no-img-element */}
          <img src={lightbox.src} alt={lightbox.alt || "photo"} className="max-h-[82vh] w-auto rounded-2xl shadow-2xl" />
          {lightbox.caption && (
            <div className="absolute bottom-6 left-1/2 -translate-x-1/2 text-sm text-white/90 bg-black/40 px-3 py-1.5 rounded">
              {lightbox.caption}
            </div>
          )}
        </div>
      )}
    </main>
  );
}



  // ====== Stage 5: ç…™ç«çµå°¾ï¼ˆé»æ“Šè§¸ç™¼ç…™ç«ï¼‰ ======
  if (stage === "finale") {
    return (
      <main className="min-h-screen flex flex-col items-center justify-center bg-black text-white relative overflow-hidden">
        <Fireworks active={true} />
        <h1 className="text-3xl sm:text-5xl font-extrabold text-white text-center drop-shadow-lg z-10">{config.finale}</h1>
        <p className="mt-4 text-sm opacity-80 z-10">â€” {config.fromName}</p>
        <button onClick={() => setStage("envelope")} className="z-10 mt-8 px-4 py-2 rounded-lg bg-white/10 border border-white/20 hover:bg-white/15">å›åˆ°é–‹é ­</button>
      </main>
    );
  }

  return null;
}

